"use strict";(self.webpackChunkros_frontend=self.webpackChunkros_frontend||[]).push([[821],{43454:(e,t,n)=>{n.r(t),n.d(t,{default:()=>he});var r=n(319),i=n.n(r),a=n(87757),o=n.n(a),s=n(48926),l=n.n(s),c=n(34575),u=n.n(c),p=n(93913),m=n.n(p),f=n(81506),d=n.n(f),h=n(2205),y=n.n(h),g=n(78585),v=n.n(g),E=n(29754),b=n.n(E),O=n(59713),w=n.n(O),k=n(1427),S=n.n(k),_=n(45697),x=n.n(_),P=n(16530),R=n(48716),z=n(39173),D=n(86350),F=n(2095),C=n(85962),j=n(86748),T=n(37703),I=n(33739),V=n(30319),N=n(18546),Z=n(76004),L=n(24814),A=n(67154),B=n.n(A),U=n(47945),H=function(e){var t=e.utilizedValue,n=e.measureLocation,r=e.eleId;return S().createElement(S().Fragment,null,S().createElement(U.Ex,B()({value:t,className:"progress-score-bar blue-300",measureLocation:n},r?{id:r}:null)))};H.propTypes={measureLocation:x().string,valueScore:x().number,utilizedValue:x().number,eleId:x().string};var G=n(84564),Q=n(19694),q=n(35451),W=n(2293),M=n(5381),X=n(82727),Y=n(18802),$=n(58773),J=function(e){var t,n=e.stateValue,r=(t=n,{Oversized:{text:"This system is not fully consuming available resources and may be oversized.",icon:S().createElement(W.ZP,{color:"#f09800",size:"sm"})},Undersized:{text:"This system is depleting available resources and may be undersized.",icon:S().createElement(M.ZP,{color:"red",size:"sm"})},Idling:{text:"This system displays higher idling cycles than is expected.",icon:S().createElement(X.ZP,{size:"sm"})},"Storage rightsizing":{text:"This system is experiencing a storage Input/Output bottleneck.",icon:S().createElement(Q.ZP,{color:"#f09800",size:"sm"})},Optimized:{text:"This system is running efficiently.",icon:S().createElement(q.ZP,{color:"green",size:"sm"})},Crashloop:{text:"This system is experiencing a crash loop.",icon:S().createElement(G.ZP,{color:"red",size:"sm"})},"Waiting for data":{text:"This system is configured, please allow 24 hours for your upload to complete.",icon:S().createElement(Y.ZP,{color:"#2B9AF3",size:"sm"})},"Under pressure":{text:"System resources adequate but experiencing occasional peaks.",icon:S().createElement($.ZP,{color:"#030303",size:"sm"})}}[t]||{}),i=r.text,a=r.icon;return S().createElement("span",null,S().createElement("span",null,i?S().createElement(Z.Tooltip,{content:S().createElement("div",null,i)},S().createElement("span",null,a," ",n)):n))};J.propTypes={stateValue:x().string};var K=n(58061);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e,t,n){var r=n.inventory_id,i=n.isDeleted,a=n.state;return i?S().createElement(Z.Tooltip,{content:S().createElement("div",null,e," has been deleted from inventory")},S().createElement("span",{tabIndex:"0"},e)):a===K.QR?S().createElement("span",null,e):S().createElement(P.Link,{to:{pathname:"/".concat(r)},className:"pf-link system-link link-".concat(r)},e)},re=function(e){return S().createElement(J,{stateValue:e})},ie=function(){return function(e,t,n){return n.state===K.QR?S().createElement("span",null,K.t0):S().createElement(H,{measureLocation:"outside",utilizedValue:e})}},ae=function(e,t,n){var r=n.inventory_id,i=n.isDeleted,a=n.state;return i?S().createElement("span",null,a===K.QR?K.t0:e):a===K.QR?S().createElement("span",null,K.t0):S().createElement(P.Link,{to:{pathname:"/".concat(r)},className:"pf-link link-".concat(r)},e)},oe=function(e,t){return te(te({},e),{},{rows:e.rows.map((function(e){return te(te({},e),{},{isOpen:e.id===t.payload.id?t.payload.isOpen:e.isOpen})}))})},se=n(53704),le=n(3955),ce=n(99621),ue=n(27839),pe=function(e,t,n){var r=n.state,i=n.performance_utilization.io_all;return r===K.QR?S().createElement("span",null,K.t0):S().createElement(Z.Tooltip,{position:"right",content:S().createElement("div",null,S().createElement("table",null,S().createElement("tr",null,S().createElement("th",null,"Device name"),S().createElement("th",null,"Value")),S().createElement("tr",null,S().createElement("td",{colSpan:"100%",className:"seperator"})),Object.keys(i).map((function(e,t){return S().createElement("tr",{key:t},S().createElement("td",null,e),S().createElement("td",null,i[e]),S().createElement("td",null,"IOPS"))}))))},S().createElement("span",null,e))};function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=function(e){y()(f,e);var t,n,r,a,s,c,p=(s=f,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b()(s);if(c){var n=b()(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v()(this,e)});function f(e){var t;return u()(this,f),t=p.call(this,e),w()(d()(t),"updateStateFilter",(function(e){t.setState({stateFilterValue:e})})),w()(d()(t),"onDeleteFilters",(function(e,n){var r=n.filter((function(e){return"State"===e.category}));if(r.length>0){var i,a=null===(i=r[0])||void 0===i?void 0:i.chips.map((function(e){return null==e?void 0:e.name})),o=t.state.stateFilterValue.filter((function(e){return!a.includes(e)}));t.setState({stateFilterValue:o})}})),w()(d()(t),"getActiveFilterConfig",(function(){var e=t.state.stateFilterValue.map((function(e){return{name:e}}));return e.length>0?[{category:"State",chips:e}]:[]})),t.state={perPage:10,orderBy:"display_name",orderDirection:j.SortByDirection.asc,columns:[{key:"display_name",title:"Name",renderFunc:ne},{key:"performance_utilization.cpu",title:"CPU utilization",renderFunc:ie()},{key:"performance_utilization.memory",title:"Memory utilization",renderFunc:ie()},{key:"performance_utilization.max_io",title:S().createElement(Z.Tooltip,{content:S().createElement("span",null,"IOPS")},S().createElement("span",null,"I/O utilization")),renderFunc:pe},{key:"number_of_suggestions",title:"Suggestions",renderFunc:ae},{key:"state",title:"State",renderFunc:re}],stateFilterValue:[]},t.sortingHeader={display_name:"display_name","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state"},t.chunkSize=50,t.inventory=S().createRef(),t.fetchSystems=t.fetchSystems.bind(d()(t)),t}return m()(f,[{key:"componentDidMount",value:(a=l()(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Resource Optimization - Red Hat Insights",null===(t=insights.chrome)||void 0===t||null===(n=t.hideGlobalFilter)||void 0===n||n.call(t,!0),insights.chrome.appAction("ros-systems"),e.next=5,this.props.isROSConfigured();case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"fetchSystems",value:(r=l()(o().mark((function e(t){var n,r,i,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return i=fe({limit:t.perPage,offset:(t.page-1)*t.perPage,order_by:t.orderBy||this.state.orderBy,order_how:t.orderHow||this.state.orderDirection},(null==t||null===(n=t.filters)||void 0===n?void 0:n.hostnameOrId)&&{display_name:t.filters.hostnameOrId}),a=new URL(K.RC+K.M4,window.location.origin),s=new URLSearchParams(i),null==t||null===(r=t.stateFilter)||void 0===r||r.forEach((function(e){s.append("state",e)})),a.search=s.toString(),e.abrupt("return",fetch(a).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"chunkIdsArray",value:function(e){for(var t=[];e.length;)t.push(e.splice(0,this.chunkSize));return t}},{key:"fetchInventoryDetails",value:(n=l()(o().mark((function e(t,n){var r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!(n.per_page>50&&t.length>50)){e.next=8;break}return e.next=4,this.multipleGetEntitiesRequests(t,n);case 4:e.sent.map((function(e){var t;(t=r).push.apply(t,i()(e))})),e.next=12;break;case 8:return e.next=10,null===(a=(s=this.state).getEntities)||void 0===a?void 0:a.call(s,t,n,!1);case 10:l=e.sent,r=l.results;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"multipleGetEntitiesRequests",value:(t=l()(o().mark((function e(t,n){var r,i=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.chunkIdsArray(t),e.abrupt("return",Promise.all(r.map(function(){var e=l()(o().mark((function e(t){var r,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=(a=i.state).getEntities)||void 0===r?void 0:r.call(a,t,n,!1);case 2:return s=e.sent,l=s.results,e.abrupt("return",l);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){return e})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"renderConfigStepsOrTable",value:function(){var e=this,t=K.N7.state;return this.props.showConfigSteps?S().createElement(le.v,null):S().createElement(F.Zb,{className:"pf-t-light  pf-m-opaque-100"},S().createElement(C.e,null,S().createElement(I.Z,{disableDefaultColumns:!0,ref:this.inventory,hasCheckbox:!1,tableProps:{canSelectAll:!1,className:"ros-systems-table"},variant:"compact",hideFilters:{all:!0,name:!1},autoRefresh:!0,customFilters:{stateFilter:this.state.stateFilterValue},getEntities:function(){var t=l()(o().mark((function t(n,r){var i,a,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState((function(){return{orderBy:r.orderBy,orderDirection:r.orderDirection}})),t.next=3,e.fetchSystems({page:r.page,perPage:r.per_page,orderBy:e.sortingHeader[r.orderBy],orderHow:r.orderDirection,filters:r.filters,stateFilter:r.stateFilter});case 3:return i=t.sent,a=(i.data||[]).map((function(e){return e.inventory_id})),t.next=7,e.fetchInventoryDetails(a,fe(fe({},r),{},{page:1,hasItems:!0}));case 7:return s=t.sent,t.abrupt("return",{results:i.data.map((function(e){var t=s.find((function(t){return t.id===e.inventory_id}));return fe(fe(fe({},t),t?{isDeleted:!1}:{id:e.inventory_id,isDeleted:!0}),e)})),total:i.meta.count,page:r.page,per_page:r.per_page});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),onLoad:function(t){var n,r,i,a,o=t.mergeWithEntities,s=t.INVENTORY_ACTION_TYPES,l=t.api;e.setState({getEntities:null==l?void 0:l.getEntities}),(0,V.z2)(fe({},o((n=s,r=e.state.columns,a=n.LOAD_ENTITIES_FULFILLED,(0,N.Gg)((i={},w()(i,a,(function(e){return function(e,t){return te(te({},t),{},{columns:e,rows:t.rows.map((function(e){return te(te({},e),{},{children:(t=e,n=t.id,r=t.cloud_provider,i=t.instance_type,a=t.idling_time,S().createElement(L.v,{id:n,cloudProvider:r,instanceType:i,idlingTime:a}))});var t,n,r,i,a})),loaded:!0})}(r,e)})),w()(i,"EXPAND_ROW",oe),i)))))),e.props.setSort(e.state.orderBy,e.state.orderDirection,"CHANGE_SORT")},expandable:"true",filterConfig:{items:[{label:t.label,type:t.type,value:"checkbox-state",filterValues:{items:t.filterValues.items,onChange:function(t,n){return e.updateStateFilter(n)},value:this.state.stateFilterValue}}]},activeFiltersConfig:{filters:this.getActiveFilterConfig(),onDelete:this.onDeleteFilters},onExpandClick:function(t,n,r,i){var a=i.id;return e.props.expandRow(a,r,"EXPAND_ROW")}})))}},{key:"render",value:function(){var e=this;return S().createElement(S().Fragment,null,S().createElement(R.Z,null,S().createElement(z.Z,{title:"Resource Optimization"})),S().createElement(D.Z,null,S().createElement(ce.B.Consumer,null,(function(t){return!1===t.permissions.systemsRead?S().createElement(ue.Z,{serviceName:"Resource Optimization"}):e.renderConfigStepsOrTable()}))))}}]),f}(S().Component);de.propTypes={expandRow:x().func,setSort:x().func,isROSConfigured:x().func,showConfigSteps:x().bool};const he=(0,P.withRouter)((0,T.$j)((function(e,t){var n;return fe({showConfigSteps:null===(n=e.isConfiguredReducer)||void 0===n?void 0:n.showConfigSteps},t)}),(function(e){return{expandRow:function(t,n,r){return e({type:r,payload:{id:t,isOpen:n}})},setSort:function(t,n,r){return e({type:r,payload:{key:t,direction:n}})},isROSConfigured:function(){return e((0,se.Pn)())}}}))(de))}}]);
//# sourceMappingURL=../sourcemaps/RosPage.101ce7dbca1454e796e18c29e9685465.js.map