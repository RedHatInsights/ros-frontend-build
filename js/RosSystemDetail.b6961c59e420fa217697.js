"use strict";(self.webpackChunkros=self.webpackChunkros||[]).push([[8693],{22273:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var a=n(44914),r=n.n(a),o=n(5556),i=n.n(o),l=n(48900),s=n(59722),c=n(41901),m=n(65769);const d=r().lazy((()=>Promise.all([n.e(9596),n.e(6074),n.e(3845),n.e(2158),n.e(3953),n.e(3715),n.e(9287),n.e(784),n.e(5847),n.e(6008)]).then(n.bind(n,4166)))),p=e=>{const t=(0,l.d4)((({entityDetails:e})=>e?.entity?.id));return r().createElement(a.Suspense,{fallback:""},r().createElement(d,{inventoryId:t,...e}))},u=({getRegistry:e,...t})=>{const[n,o]=(0,a.useState)();return(0,a.useEffect)((()=>{e&&e()?.register?.({systemRecsReducer:s.Jw}),o((()=>e?l.Kq:a.Fragment))}),[e]),n?r().createElement(n,{...e&&{store:e().getStore()}},r().createElement(p,{...t})):r().createElement(c.Bullseye,null,r().createElement(m.Spinner,{size:"xl"}))};u.propTypes={getRegistry:i().func};const h=u},33855:(e,t,n)=>{n.r(t),n.d(t,{default:()=>me});var a=n(44914),r=n.n(a),o=n(5556),i=n.n(o),l=n(16885),s=n(48900),c=n(20437),m=n(80939),d=n(65769),p=n(54226),u=n(24209),h=n(87945),g=n(1330),y=n(73349),E=n(41526),f=n(66108);const w={loaded:!1},D=e=>({...e,loaded:!0});var S=n(59094),I=n(53781),_=n(66015),v=n(49328),T=n.n(v),b=n(72196),x=n.n(b),C=n(68580),L=n.n(C),k=n(30002),N=n.n(k),R=n(81538);const A=({system:e})=>{const[t,n]=(0,a.useState)(e.rating),[o,i]=(0,a.useState)(!1),l=async a=>{const r=t===a?R.A6:a;try{const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({inventory_id:e.inventoryId,rating:r})};await fetch(`${R.ZA}${R.rf}`,t),n(r),i(!0),setTimeout((()=>i(!1)),3e3)}catch(e){console.error(e)}};return r().createElement("span",{className:"ratingSpanOverride"},"Is this suggestion helpful?",r().createElement(I.Button,{variant:"plain","aria-label":"thumbs-up",onClick:()=>l(R.EM),ouiaId:"thumbsUp"},t===R.EM?r().createElement(L(),{className:"like",size:"sm"}):r().createElement(_.Icon,{size:"md"},r().createElement(T(),null))),r().createElement(I.Button,{variant:"plain","aria-label":"thumbs-down",onClick:()=>l(R.ov),ouiaId:"thumbsDown"},t===R.ov?r().createElement(N(),{className:"dislike",size:"sm"}):r().createElement(x(),{size:"sm"})),o&&"Thank you for your feedback!")};A.propTypes={system:i().object};const z=A;var F=n(57707),O=n(36683),U=n(55740),P=n(51259),j=n(41853),B=n(25847),$=n(69773),M=n(3854),G=n(72049),Z=n(32495),V=n(46273),Y=n(53936),H=n(14431),X=n(87308),K=n(64138),J=n(7130),W=n(41901),q=n(19461),Q=n(38845),ee=n(80795),te=n(35227),ne=n(75724),ae=n.n(ne),re=n(13460);const oe=({inventoryId:e})=>{const[t,n]=(0,a.useState)(!1),[o,i]=(0,a.useState)(R.dg),[l,s]=(0,a.useState)([]),[c,m]=(0,a.useState)(!1),p=(0,M.g)("zoom","voronoi");(0,a.useEffect)((()=>{s([]),async function(){try{const t=o===R.dg?R.dg:R.GT,n=((e,t)=>{const n=[];let a=new Date;const r={datapoints:[]},o={datapoints:[]};let i=new Map;e.reverse().forEach((e=>{i.set(new Date(e.report_date).toDateString(),e)}));for(let e=t-1;e>=0;e--){let t=new Date;t=new Date(t.setDate(a.getDate()-e)).toDateString(),i.has(t)?(r.datapoints.push({name:"CPU Utilization",x:new Date(t),y:i.get(t).cpu}),o.datapoints.push({name:"Memory Utilization",x:new Date(t),y:i.get(t).memory})):(r.datapoints.push({name:"CPU Utilization",x:new Date(t),y:null}),o.datapoints.push({name:"Memory Utilization",x:new Date(t),y:null}))}return n.push(r),n.push(o),n})((await(0,re.yz)(e,t)).data,o);s(n)}catch(e){m(!0)}}()}),[o]);const u=e=>{e!==o&&s([]),i(e),n(!t)},h=()=>{n(!t)};return c?r().createElement(j.FlexItem,{alignSelf:{default:"alignSelfBaseline"}},r().createElement(q.EmptyState,{variant:q.EmptyStateVariant.sm},r().createElement(q.EmptyStateHeader,{titleText:"Something went wrong",headingLevel:"h2"}),r().createElement(q.EmptyStateBody,null,"There was a problem while requesting historical data. Please try again later."))):0===l.length?r().createElement(j.FlexItem,{alignSelf:{default:"alignSelfBaseline"}},r().createElement(W.Bullseye,null,r().createElement(d.Spinner,{size:"xl","aria-labelledby":"loading-historical-chart"}))):r().createElement(j.Flex,{direction:{default:"column"},alignSelf:{default:"alignSelfBaseline"},align:{default:"alignRight"}},r().createElement(j.FlexItem,{align:{default:"alignRight"}},r().createElement("div",{className:"chartDateFilter"},r().createElement(Q.Tooltip,{content:r().createElement("div",null,"Scroll and pan to zoom and move")},r().createElement(_.Icon,{style:{marginBottom:"16px",paddingRight:"8px"},size:"md"},r().createElement(ae(),null))),r().createElement(ee.Dropdown,{className:"dateDropdown",isOpen:t,onSelect:(e,t)=>n(t),onOpenChange:e=>n(e),toggle:e=>r().createElement(te.MenuToggle,{ref:e,onClick:h,isExpanded:t},`Last ${o===R.dg?R.dg:R.GT} Days`),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0},r().createElement(ee.DropdownList,null,r().createElement(ee.DropdownItem,{key:"action_7",onClick:()=>u(R.dg)},"Last 7 Days"),r().createElement(ee.DropdownItem,{key:"action_45",onClick:()=>u(R.X)},"Last 45 Days"))))),r().createElement(j.FlexItem,{align:{default:"alignRight"},className:"historical-chart-panel"},r().createElement(G.t,{domain:(()=>{const e=new Date;let t=new Date;const n=o===R.dg?R.dg:R.X;return t=new Date(t.setDate(e.getDate()-n)),{y:[0,100],x:[t,e]}})(),scale:{x:"time",y:"linear"},containerComponent:r().createElement(p,{labels:({datum:e})=>(e=>{const t=new Date(e.x);let n=(new Date).toDateString()===t.toDateString()?"Today":`${t.getDate()} ${R.KR[t.getMonth()]}`;return n=e.name.includes("CPU")?`${n}\n   \n`:"",e.childName.includes("scatter-")&&null!==e.y?`${n}${e.name}: ${e.y}%`:null})(e),labelComponent:r().createElement(Z.y,{labelComponent:r().createElement(V.j,{style:[{fill:"white",fontSize:16,fontWeight:700},{fill:"white"},{fill:"white"},{fill:"white"}]})}),constrainToVisibleArea:!0,voronoiDimension:"x",zoomDimension:"x"}),legendData:[{name:"CPU Utilization"},{name:"Memory Utilization"}],legendOrientation:"vertical",legendPosition:"right",height:275,width:756,maxDomain:{y:100},minDomain:{y:0},padding:{bottom:50,left:50,right:165,top:50},themeColor:Y.L.blue},r().createElement(H.c,{tickValues:l[0].datapoints.map((e=>e.x)),tickFormat:e=>(new Date).toDateString()===new Date(e).toDateString()?"Today":`${new Date(e).getDate()} ${R.KR[new Date(e).getMonth()]}`,fixLabelOverlap:!0,tickCount:6}),r().createElement(H.c,{dependentAxis:!0,showGrid:!0,tickValues:[0,20,40,60,80,100],tickFormat:e=>`${e}%`}),r().createElement(X.E,null,l.map(((e,t)=>r().createElement(K.B,{data:e.datapoints,key:"scatter-"+t,name:"scatter-"+t})))),r().createElement(X.E,null,l.map(((e,t)=>r().createElement(J.B,{key:"line-"+t,name:"line-"+t,data:e.datapoints})))))))};oe.propTypes={inventoryId:i().string};var ie=n(22273),le=n(20881),se=n(17913);class ce extends r().Component{constructor(e){super(e),this.state={inventoryId:this.props.params.inventoryId}}componentDidMount(){const e=this.props.chrome;e?.hideGlobalFilter?.(!0),e.appAction("system-detail"),this.props.loadSystemInfo(this.state.inventoryId)}componentDidUpdate(){const e=this.props.chrome,t=this.props.rosSystemInfo.display_name;t&&t!==document.title&&e?.updateDocumentTitle(t)}renderChildrenNode(){if(this.props.rosSystemInfo){const{cloud_provider:e,instance_type:t,idling_time:n,report_date:a,rating:o,state:i}=this.props.rosSystemInfo,{inventoryId:l}=this.props.params;return r().createElement(j.Flex,{alignItems:{default:"alignItemsCenter"}},r().createElement(j.Flex,{grow:{default:"grow"},className:"ros-system-info"},r().createElement(j.Flex,{flex:{default:"flex_4"},direction:{default:"column"}},r().createElement(j.FlexItem,null,r().createElement($.DescriptionList,{className:"expanded-row",isCompact:!0,isHorizontal:!0},r().createElement($.DescriptionListGroup,null,r().createElement($.DescriptionListTerm,null,"Last reported"),r().createElement($.DescriptionListDescription,null,(0,P._1)(a))),r().createElement($.DescriptionListGroup,null,r().createElement($.DescriptionListTerm,null,"State"),r().createElement($.DescriptionListDescription,null,r().createElement(F.l,{stateValue:i})))),r().createElement(S.g,{cloudProvider:e,instanceType:t,idlingTime:n,inventoryId:l}),r().createElement(z,{system:{rating:o,inventoryId:l}}))),r().createElement(j.Flex,{grow:{default:"grow"},direction:{default:"column"}},r().createElement(oe,{inventoryId:l}))))}return null}render(){const e=this.props.entity;return r().createElement(r().Fragment,null,r().createElement(U.d.Consumer,null,(t=>!1===t.permissions.hasRead?r().createElement(O.A,{serviceName:R.OX}):r().createElement(h.A,{inventoryId:this.state.inventoryId,onLoad:({mergeWithDetail:e,INVENTORY_ACTION_TYPES:t})=>{(0,y.kz)(e((({LOAD_ENTITY_FULFILLED:e})=>(0,f.Lr)({[e]:D},w))(t)))},className:"rosDetailWrapper"},r().createElement(u.A,null,r().createElement(m.Breadcrumb,{ouiaId:"system-detail"},r().createElement(m.BreadcrumbItem,null,r().createElement(se.A,{to:"/"},"Resource Optimization")),r().createElement(m.BreadcrumbItem,{isActive:!0},r().createElement("div",{className:"ins-c-inventory__detail--breadcrumb-name"},e?e.display_name:null))),r().createElement(B.Stack,{hasGutter:!0},r().createElement(B.StackItem,null,r().createElement(g.A,{hideBack:!0,showDelete:!1,hideInvDrawer:!0,className:"rosDetailsHead"})),r().createElement(B.StackItem,{isFilled:!0},this.renderChildrenNode()))),r().createElement(p.Ay,null,r().createElement(c.Grid,{gutter:"md"},r().createElement(c.GridItem,{span:12},e?r().createElement(ie.default,{showTags:!0,fallback:""}):r().createElement(d.Spinner,null))))))))}}ce.propTypes={params:i().object,entity:i().object,loading:i().bool,rosSystemInfo:i().object,loadSystemInfo:i().func,chrome:i().object};const me=(0,s.Ng)(((e,t)=>({entity:e.entityDetails&&e.entityDetails.entity,loading:e.systemDetailReducer?.loading,rosSystemInfo:e.systemDetailReducer?.systemInfo,...t})),(function(e){return{loadSystemInfo:t=>e((0,E.kZ)(t))}}))((e=>{const t=(0,le.A)(),n=(0,l.useParams)();return r().createElement(ce,{...e,chrome:t,params:n})}))},13460:(e,t,n)=>{n.d(t,{BA:()=>d,DE:()=>l,c:()=>p,ne:()=>i,yj:()=>s,yz:()=>m,zu:()=>c});var a=n(85736),r=n(81538);function o(e){if(!e.ok)throw Error(e.statusText);return e}const i=()=>{let e=new URL(r.ZA+r.Vg,window.location.origin);return fetch(e).then(o).then((e=>e.json())).then((e=>e))},l=e=>{let t=new URL(r.ZA+r.jC+`/${e}`,window.location.origin);return fetch(t).then(o).then((e=>e.json())).then((e=>e))},s=(e,t={})=>{let n={limit:t.perPage,offset:(t.page-1)*t.perPage};t.description&&t.description.trim()&&(n={...n,description:t.description});let a=new URL(r.ZA+r.jC+`/${e}/suggestions`,window.location.origin);return a.search=new URLSearchParams(n).toString(),fetch(a).then((e=>{if(!e.ok&&404===e.status)return{hasError:!0};if(!e.ok)throw Error(e.statusText);return e.json()})).then((e=>e))},c=async e=>{const{perPage:t,orderBy:n,orderHow:o}=e||{};let i={order_by:{display_name:"display_name",groups:"group_name",os:"os","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state",report_date:"report_date"}[n]||"report_date",order_how:o||a.l.desc,limit:t||-1,...e?.page&&{offset:(e.page-1)*e.perPage},...e?.filters?.hostnameOrId&&{display_name:e.filters.hostnameOrId}},l=new URL(r.ZA+r.jC,window.location.origin),s=new URLSearchParams(i);return e?.stateFilter?.forEach((e=>{s.append("state",e)})),e?.osFilter?.forEach((e=>{s.append("os",e)})),e?.groupFilter?.forEach((e=>{s.append("group_name",e)})),l.search=s.toString(),fetch(l).then((e=>{if(!e.ok)throw Error(e.statusText);return e})).then((e=>e.json()))},m=(e,t)=>{let n=new URL(`${r.ZA}${r.jC}/${e}/history`,window.location.origin),a=new URLSearchParams({limit:t});return n.search=a.toString(),fetch(n).then(o).then((e=>e.json())).then((e=>e))},d=async()=>{const e=new URL(r.X9,window.location.origin);return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"ros",template:"executiveReport"})}).then(o).then((e=>e.blob()))},p=async e=>{const{page:t,perPage:n,activeSortColumnKey:a,activeSortDirection:i}=e||{};let l=new URL(r.ZA+r.XQ,window.location.origin),s={page:t,per_page:n,order_by:a,order_how:i,...e?.instanceTypeName&&{instance_type:e.instanceTypeName}},c=new URLSearchParams(s);return l.search=c.toString(),fetch(l).then(o).then((e=>e.json())).then((e=>e))}},41526:(e,t,n)=>{n.d(t,{NI:()=>i,RZ:()=>l,ds:()=>o,iS:()=>s,kZ:()=>r});var a=n(13460);const r=e=>({type:"LOAD_ROS_SYSTEM_INFO",payload:(0,a.DE)(e)}),o=(e,t)=>({type:"FETCH_SYSTEM_RECOMMENDATIONS_LIST",payload:(0,a.yj)(e,t)}),i=()=>({type:"LOAD_IS_CONFIGURED_INFO",payload:(0,a.ne)()}),l=e=>({type:"CHANGE_SYSTEM_COLUMNS",payload:e}),s=e=>({type:"LOAD_SUGGESTED_INSTANCE_TYPES",payload:(0,a.c)(e)})}}]);
//# sourceMappingURL=../sourcemaps/RosSystemDetail.1405a799e264325ec0049d00a299a23e.js.map