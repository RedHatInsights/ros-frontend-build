(self.webpackChunkros_frontend=self.webpackChunkros_frontend||[]).push([[821],{3955:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var r=n(45103),o=n(2112),a=n(43297),i=n.n(a),s=n(58061),c=function(){return i().createElement(r.Bullseye,null,i().createElement(r.EmptyState,{className:"empty-state-not-configured"},i().createElement(r.EmptyStateIcon,{icon:o.ZP}),i().createElement(r.Title,{headingLevel:"h5",size:"lg"},"Resource optimization isn't configured yet"),i().createElement(r.EmptyStateBody,null,i().createElement(r.Bullseye,null,i().createElement(r.Stack,{hasGutter:!0},i().createElement(r.StackItem,null,"Resource Optimization requires installing and configuring Performance Co-Pilot on the client system."),i().createElement(r.StackItem,null,"Check the documentation to find how to configure Resource Optimization with Ansible. An alternative method which does not require Ansible is also described."),i().createElement(r.StackItem,null,"After configuring Resource Optimization, it may take up to 24 hours until suggestions are available.")))),i().createElement(r.Button,{component:"a",href:s.wy,target:"_blank",variant:"primary"},"Getting started documentation")))}},8970:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ze});var r=n(319),o=n.n(r),a=n(87757),i=n.n(a),s=n(48926),c=n.n(s),l=n(34575),u=n.n(l),p=n(93913),d=n.n(p),m=n(81506),f=n.n(m),h=n(2205),y=n.n(h),g=n(78585),v=n.n(g),E=n(29754),b=n.n(E),w=n(59713),x=n.n(w),O=n(43297),S=n.n(O),C=n(45697),k=n.n(C),_=n(16530),P=n(80123),D=n(39173),F=n(14748),R=n(45103),j=n(88587),T=n(2983),z=n(33739),I=n(30319),B=n(70702),N=n(94778),A=n(58061),H=n(3955),L=n(87999),U=n(85333),M=n(63038),V=n.n(M);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=e.modalColumns,n=e.isModalOpen,r=e.setModalOpen,a=e.saveColumns,i=(0,O.useState)(t),s=V()(i,2),c=s[0],l=s[1],u=function(){r(!1),l(t)};return S().createElement(R.Modal,{title:"Manage columns",onClose:u,isOpen:n,variant:"small",description:S().createElement(R.TextContent,null,S().createElement(R.Text,{component:R.TextVariants.p},"Selected categories will be displayed in the table"),S().createElement(R.Split,{hasGutter:!0},S().createElement(R.SplitItem,null,S().createElement(R.Button,{isInline:!0,onClick:function(){l(c.map((function(e){return q(q({},e),{},{isChecked:!0})})))},variant:"link"},"Select all")),S().createElement(R.SplitItem,null,S().createElement(R.Button,{isInline:!0,onClick:function(){l(c.map((function(e){var t;return q(q({},e),{},{isChecked:null!==(t=e.isShownByDefault)&&void 0!==t&&t})})))},variant:"link"},"Reset to default")))),actions:[S().createElement(R.Button,{key:"save",variant:"primary",onClick:function(){r(!1),a(c)}},"Save"),S().createElement(R.Button,{key:"cancel",variant:"secondary",onClick:u},"Cancel")]},S().createElement(R.DataList,{"aria-label":"Column management table",id:"column-management-table",isCompact:!0},c.map((function(e,t){return S().createElement(R.DataListItem,{key:e.key},S().createElement(R.DataListItemRow,null,S().createElement(R.DataListCheck,{checked:e.isChecked,id:"checkbox-".concat(t),onChange:function(){return function(e){var t=o()(c),n=q({},t[e]);n.isChecked=!n.isChecked,t[e]=n,l(t)}(t)},isDisabled:e.isDisabled}),S().createElement(R.DataListItemCells,{dataListCells:[S().createElement(R.DataListCell,{key:"column-table-item-".concat(t)},S().createElement("label",null,e.modalTitle))]})))}))))};Q.propTypes={modalColumns:k().arrayOf(k().object).isRequired,isModalOpen:k().bool.isRequired,setModalOpen:k().func.isRequired,saveColumns:k().func.isRequired};var W=n(67154),Y=n.n(W),Z=n(6479),$=n.n(Z),K=n(3968),X=n(58773),J=n(5381),ee=n(2293),te=n(82727),ne=n(18802),re=n(35451),oe=["display_name","os","performance_utilization.cpu","performance_utilization.memory","performance_utilization.max_io","number_of_suggestions","state","report_date"],ae=["display_name","os","performance_utilization.cpu","performance_utilization.memory","performance_utilization.max_io","number_of_suggestions","state","cloud_provider","instance_type","idling_time","report_date"],ie=["performance_utilization.cpu","performance_utilization.memory","idling_time"],se={variant:"info",title:"Generating data. Download may take a moment to start."},ce={variant:"success",title:"Export successful"},le={variant:"danger",autoDismiss:!1,title:"Export failed. Please try exporting again."},ue=[{title:"Optimized",description:"Performing at an optimal level",iconPath:re.GR.svgPath,iconScale:.014,fillColor:"green"},{title:"Under pressure",description:"Peaking occasionally",iconPath:X.wP.svgPath,iconScale:.014,fillColor:"#030303"},{title:"Undersized",description:"Using more than 80% of system resources",iconPath:J.MA.svgPath,iconScale:.014,fillColor:"red"},{title:"Oversized",description:"Using less than 20% of system resources",iconPath:ee.zN.svgPath,iconScale:.014,fillColor:"#f09800"},{title:"Idling",description:"Consuming less than 5% of resources",iconPath:te.hh.svgPath,iconScale:.008,fillColor:"#030303"},{title:"Waiting for data",description:"Data has not been received or is being processed. Initial data processing takes up to 24 hours.",iconPath:ne.Y3.svgPath,iconScale:.008,fillColor:"#2B9AF3"}],pe=[{title:"CPU pressure",description:"CPU registered peaks higher than 20% over several one-minute time periods"},{title:"Disk I/O  pressure",description:"Disk I/O registered peaks higher than 20% over several one-minute time periods"},{title:"RAM pressure",description:"RAM registered peaks higher than 20% over several one-minute time periods"}],de=n(30859),me=n(27361),fe=n.n(me),he=n(39371),ye=function(e,t){var n=[],r="json"===t?ae:oe;return e.map((function(e){var o="json"===t?{}:[];r.map((function(n){var r=fe()(e,n,"");r="N/A"!==(r=null===r||-1===r?"N/A":r.toString())&&ie.includes(n)?"".concat(r,"%"):r,r="report_date"===n?(0,he.dateStringByType)("exact")(new Date(r)):r,"json"===t?o[n]=r:"pdf"===t&&o.push(r)})),n.push(o)})),n},ge=function(e){var t=ye(e,"json");return JSON.stringify(t)},ve=function(e){var t=ye(e,"json"),n=Object.keys(t[0]);return[n.join(",")].concat(o()(t.map((function(e){return n.map((function(t){return e[t]})).join(",")})))).join("\r\n")},Ee=function(e){var t,n,r,o="",a="\n",i=(null==e||null===(t=e.stateFilter)||void 0===t?void 0:t.length)>0,s=(null==e||null===(n=e.hostnameOrId)||void 0===n?void 0:n.length)>0,c=(null==e||null===(r=e.osFilter)||void 0===r?void 0:r.length)>0;return(i||s||c)&&(o="".concat(a,"Filters applied").concat(a),o=s?o.concat("Name: ".concat(e.hostnameOrId).concat(a)):o,o=i?o.concat("State: ".concat(e.stateFilter.toString()).concat(a)):o,o=c?o.concat("Operating System: ".concat(e.osFilter.sort().toString()).concat(a)):o),o},be=function(){var e="".concat((new Date).toISOString().replace(/[T:]/g,"-").split(".")[0],"-utc");return"".concat("resource_optimization--").concat(e)},we=function(e,t,n){return n||(n="".concat(t,"s")),"".concat(1===e?t:n)},xe=n(69748),Oe=n(94805);const Se=xe.mM.create({bodyCell:{textAlign:"left",fontSize:8,paddingBottom:2,paddingTop:2,paddingRight:2,flex:1},headerCell:{textAlign:"left",fontSize:8,flex:1},systemNameCell:{textAlign:"left",fontSize:8,flex:2.5,paddingBottom:2,paddingTop:2,paddingRight:2},lastReportedCell:{textAlign:"left",fontSize:8,flex:1.2,paddingBottom:2,paddingTop:2,paddingRight:2},headerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-around"},rowStyle:{display:"flex",flexDirection:"row",justifyContent:"center"},execHeading:{textAlign:"left",fontSize:10,color:"#C9190B",marginBottom:4,marginTop:10},occurrenceHeading:{textAlign:"left",fontSize:10,color:"#C9190B",marginTop:12,marginBottom:-4},execInfoText:{flex:1,textAlign:"right",fontSize:7,color:"#6A6E73"},instanceTypeHeading:{textAlign:"left",fontSize:10,color:"#C9190B",marginTop:20},instanceTypeHeadingFirst:{textAlign:"left",fontSize:10,color:"#C9190B"},instanceTypeDesc:{fontSize:10,textAlign:"left",marginBottom:4},flexRow:{display:"flex",flexDirection:"row"},tableRowBackground:{backgroundColor:Oe.ZP.value},instanceTableHeading:{fontSize:10,color:"#6A6E73",paddingBottom:4,fontWeight:"bold"},bold:{fontFamily:"Helvetica-Bold",fontWeight:700}});var Ce=function(e){var t=e.value,n=e.style,r=e.key;return S().createElement(xe.xv,{key:r,style:n},t)},ke=["Name","OS","CPU utilization","Memory utilization","I/O utilization","Suggestions","State","Last reported"],_e=function(e){var t=e.data,n=e.page,r=ke.map((function(e,t){var n="Name"===e?[Se.systemNameCell]:"Last reported"===e?[Se.lastReportedCell]:[Se.headerCell];return Ce({value:e,style:n,key:"".concat(t,"-").concat(e)})})),a=t.map((function(e){return e.map((function(e,t){var n=ke.indexOf("Name"),r=ke.indexOf("Last reported"),o=t===n?[Se.systemNameCell]:t===r?[Se.lastReportedCell]:[Se.bodyCell];return Ce({value:e,style:o,key:"".concat(t,"-").concat(e)})}))}));return S().createElement(O.Fragment,{key:n},S().createElement(K.$0,null,S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:[r].concat(o()(a))}))))};_e.propTypes={data:k().array,page:k().number},Ce.propTypes={value:k().string,style:k().array,key:k().string};var Pe=function(e){var t=e.data,n=e.totalSystems,r=e.filterText;return S().createElement(O.Fragment,{key:"first-section"},S().createElement(K.$0,null,S().createElement(K.sg,null,"This report identified ".concat(n," ").concat(n>1?"RHEL systems":"RHEL system",". ").concat(r))),S().createElement(_e,{data:t,page:0}))};Pe.propTypes={data:k().array,totalSystems:k().number,filterText:k().string};var De=n(83215),Fe=function(e){var t=e.filters,n=e.orderBy,r=e.orderHow,a=$()(e,["filters","orderBy","orderHow"]),s=be(),l=(0,T.I0)(),u=se,p=ce,d=le;(0,O.useEffect)((function(){l((0,De.wN)(u))}),[]);var m=function(){var e=c()(i().mark((function e(t,n,r){var a,s,c,u,m,f,h,y,g;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=16,u=22,m={filters:t,stateFilter:t.stateFilter,osFilter:t.osFilter,orderBy:n,orderHow:r},e.prev=2,e.next=5,(0,de.lc)(m);case 5:f=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),l((0,De.L1)()),l((0,De.wN)(d)),e.abrupt("return",[]);case 13:for(h=ye(f.data,"pdf"),y={data:h.splice(0,c),totalSystems:null===(a=f)||void 0===a||null===(s=a.meta)||void 0===s?void 0:s.count,filterText:Ee(t)},g=[];h.length>0;)g.push(h.splice(0,u));return l((0,De.L1)()),l((0,De.wN)(p)),e.abrupt("return",[S().createElement(Pe,Y()({key:"first-page"},y))].concat(o()(g.map((function(e,t){return S().createElement(_e,{key:t,data:e,page:t+1})})))));case 20:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,r){return e.apply(this,arguments)}}();return S().createElement("div",null,S().createElement(K.o6,Y()({},a,{reportName:"Insights Resource Optimization Systems Report",type:"",fileName:"".concat(s,".pdf"),size:"A4",orientation:"landscape",allPagesHaveTitle:!1,asyncFunction:function(){return m(t,n,r)}})))};Fe.propTypes={filters:k().object,orderBy:k().string,orderHow:k().string};var Re=n(1284),je=function(){var e=c()(i().mark((function e(t,n,r,o,a,s){var c,l,u,p,d,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=be(),l=ce,u=le,a(se),p={filters:n,stateFilter:n.stateFilter,osFilter:n.osFilter,orderBy:r,orderHow:o},e.prev=4,e.next=7,(0,de.lc)(p);case 7:d=e.sent,m="json"===t?ge(d.data):ve(d.data),(0,Re.downloadFile)(m,c,t),s(),a(l),e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(4),s(),a(u),"".concat(e.t0);case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t,n,r,o,a,i){return e.apply(this,arguments)}}(),Te=n(1657),ze=n(11676),Ie=function(e){var t=e.width,n=void 0===t?15:t,r=e.height,o=void 0===r?10:r,a=e.padding,i=void 0===a?2:a,s=e.iconScale,c=void 0===s?.014:s,l=e.iconPath,u=void 0===l?ze.DK.svgPath:l,p=e.fillColor,d=void 0===p?"#8BC1F7":p;return S().createElement(xe.Xz,{style:{width:n,height:o,padding:i},paint:function(e){var t=e.path;(0,e.scale)(c),t(u).fill(d)}})};Ie.propTypes={width:k().number,height:k().number,padding:k().number,iconScale:k().number,iconPath:k().string,fillColor:k().string};var Be=function(e){var t,n,r=e.data,a=null==r?void 0:r.meta,i=a.conditions_count,s=a.non_optimized_count,c=a.non_psi_count,l=a.psi_enabled_count,u=a.total_count,p=a.stale_count,d=null==r||null===(t=r.systems_per_state)||void 0===t||null===(n=t.optimized)||void 0===n?void 0:n.count,m=function(e){var t=e.systems_per_state,n=e.conditions,r=[],o=[["# of systems"]],a=[],i=[["# of occurrences"]],s={io:{name:"Disk IO",occurrences:[]},memory:{name:"RAM",occurrences:[]},cpu:{name:"CPU",occurrences:[]}},c={idling:"Idling",oversized:"Oversized",under_pressure:"Under pressure",undersized:"Undersized",waiting_for_data:"Waiting for data",optimized:"Optimized"};return Object.keys(t).map((function(e){var n,a,i=c[e],s=null===(n=t[e])||void 0===n?void 0:n.percentage,l=null===(a=t[e])||void 0===a?void 0:a.count;r.push({x:i,y:s}),o.push(["".concat(l," (").concat(s,"% of total)")])})),Object.keys(n).map((function(e){var t,r,o=s[e].name,c=Math.floor(null===(t=n[e])||void 0===t?void 0:t.percentage),l=null===(r=n[e])||void 0===r?void 0:r.count;a.push({x:o,y:c}),i.push(["".concat(l)]);var u=null!==n[e].under_pressure?n[e].under_pressure:0,p=null!==n[e].undersized?n[e].undersized:0,d=null!==n[e].oversized?n[e].oversized:0;s[e].occurrences.push(["Under pressure","".concat(u,"*")]),-1!==p&&-1!==d&&(s[e].occurrences.push(["Undersized","".concat(p)]),s[e].occurrences.push(["Oversized","".concat(d)]))})),{stateChartData:r,stateTableData:o,conditionsChartData:a,conditionsTableData:i,conditionsInfo:s}}(r),f=m.stateChartData,h=m.stateTableData,y=m.conditionsChartData,g=m.conditionsTableData,v=m.conditionsInfo;return S().createElement(O.Fragment,{key:"first-page"},S().createElement(xe.xv,null,"This executive summary highlights the performance for your registered systems included in the resource optimization service."),S().createElement(xe.xv,{style:Se.execHeading},"Registered systems"),S().createElement(xe.xv,null,S().createElement(xe.xv,null,"There ".concat(we(u,"is","are"))),S().createElement(xe.xv,{style:Se.bold}," ".concat(u," registered ").concat(we(u,"system")," ")),S().createElement(xe.xv,null,"in the resource optimization service.".concat("\n")),S().createElement(xe.xv,{style:Se.bold},"".concat(d)),S().createElement(xe.xv,null," of ".concat(u," ").concat(we(u,"system")," ").concat(we(d,"is","are")," identified as ")),S().createElement(xe.xv,{style:Se.bold},"optimized, "),S().createElement(xe.xv,{style:Se.bold},"".concat(s)),S().createElement(xe.xv,null," of ".concat(u," ").concat(we(u,"system")," as having a ")),S().createElement(xe.xv,{style:Se.bold},"non-optimal"),S().createElement(xe.xv,null," state.".concat("\n")),S().createElement(xe.xv,{style:Se.bold},"".concat(p)),S().createElement(xe.xv,null," of ".concat(u," ").concat(we(u,"system")," ").concat(we(p,"is","are")," ")),S().createElement(xe.xv,{style:Se.bold},"stale*")),S().createElement(xe.xv,{style:Se.execInfoText},"Suggestions for stale systems might no longer apply due to systems not being refreshed in 7 days.*"),S().createElement(xe.xv,{style:Se.execHeading},"Breakdown of registered systems"),c>0&&S().createElement(xe.xv,null,"".concat(l," ").concat(we(l,"system")," out of a total of ").concat(u," ").concat(we(u,"system")," have Kernel Pressure Stall Information enabled. You could get better suggestions for ").concat(c," ").concat(we(c,"system")," if you enabled Pressure Stall Information. Check the documentation on how to enable PSI on versions RHEL 8 and newer.")),S().createElement(K.$0,null,S().createElement(K.sg,null,S().createElement(K.kL,{chartType:"pie",subTitle:"Non-optimal",title:s,data:f,colorSchema:"multi",legendHeader:"State",showLabels:!1,labels:function(){return""}})),S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:h}))),S().createElement(xe.xv,{style:Se.execInfoText},"Description of states are on the last page of the report*"),S().createElement(xe.xv,{style:Se.execHeading},"System performance issues"),S().createElement(xe.xv,null,"There are ".concat(i," system performance issues.")),S().createElement(K.$0,null,S().createElement(K.sg,null,S().createElement(K.kL,{chartType:"donut",subTitle:"Conditions",title:i,data:y,colorSchema:"blue",legendHeader:"Conditions",showLabels:!1})),S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:g}))),function(e){var t=[[S().createElement(xe.G7,{key:"disk-io-title",style:Se.flexRow},S().createElement(Ie,{fillColor:"#0066CC"}),S().createElement(xe.xv,null,"Disk I/O"))]],n=[[S().createElement(xe.G7,{key:"memory-title",style:Se.flexRow},S().createElement(Ie,{fillColor:"#8BC1F7"}),S().createElement(xe.xv,null,"RAM"))]],r=[[S().createElement(xe.G7,{key:"cpu-title",style:Se.flexRow},S().createElement(Ie,{fillColor:"#002F5D"}),S().createElement(xe.xv,null,"CPU"))]];return t.push.apply(t,o()(e.io.occurrences)),n.push.apply(n,o()(e.memory.occurrences)),r.push.apply(r,o()(e.cpu.occurrences)),S().createElement(xe.G7,null,S().createElement(xe.xv,{style:Se.occurrenceHeading},"Breakdown of occurences"),S().createElement(K.$0,null,S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:t})),S().createElement(K.sg,{style:{flex:.2}}),S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:n})),S().createElement(K.sg,{style:{flex:.2}}),S().createElement(K.sg,null,S().createElement(K.iA,{withHeader:!0,rows:r}))),S().createElement(xe.xv,{style:Se.execInfoText},"Under pressure (*) conditions are only reported for systems where Kernel Pressure Stall Information is enabled. Check the documentation for details.*"),S().createElement(xe.xv,{style:Se.execInfoText},"Description of conditions are on the second page of the report*"))}(v))};function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Be.propTypes={data:k().object};var He=function(e){var t=e.id,n=e.instanceDetails,r=e.heading,o=e.description;return S().createElement(xe.G7,null,S().createElement(xe.xv,{style:"current_instance_types"===t?Se.instanceTypeHeadingFirst:Se.instanceTypeHeading},r),S().createElement(xe.xv,{style:Se.instanceTypeDesc},o),S().createElement(xe.G7,{key:t,style:Se.flexRow},S().createElement(xe.xv,{style:[{width:100},Se.instanceTableHeading]},"Instance type"),S().createElement(xe.xv,{style:[{width:80},Se.instanceTableHeading]},"# of ".concat("historical_instance_types"===t?"times":"systems")),S().createElement(xe.xv,{style:[{flex:1},Se.instanceTableHeading]},"Description")),n.length>0?n.map((function(e,n){return S().createElement(xe.G7,{key:"".concat(t,"-").concat(n),style:Ae(Ae({},Se.flexRow),n%2&&Ae({},Se.tableRowBackground))},S().createElement(xe.xv,{style:{width:100}},e.type),S().createElement(xe.xv,{style:{width:80,paddingLeft:4}},e.count),S().createElement(xe.xv,{style:{flex:1}},e.desc))})):S().createElement(xe.xv,{style:Se.instanceTableHeading},"No data available."))};He.propTypes={id:k().string,instanceDetails:k().array,heading:k().string,description:k().string};var Le=function(e){var t=e.data,n=null==t?void 0:t.instance_types_highlights,r=n.current,o=n.suggested,a=n.historical,i=(null==t?void 0:t.meta).stale_count,s=[{id:"current_instance_types",heading:"Most used current instance types",description:"We have identified these instance types based on the data from the fresh systems.",data:r},{id:"suggested_instance_types",heading:"Most suggested instance types",description:"We are suggesting these instance types based on the data from the fresh systems.",data:o},{id:"historical_instance_types",heading:"Most suggested instance types (45 days)",description:"In the last 45 days we suggested you these instances # of times. ",staleDescription:"Some of the instances are now identified as stale (more than 7 days not reporting data).",data:a}];return S().createElement(O.Fragment,{key:"third-page"},s.map((function(e,t){return S().createElement(He,{key:"".concat(t,"-").concat(e.id),id:e.id,instanceDetails:e.data,heading:e.heading,description:i>0&&e.id.includes("historical")?"".concat(e.description).concat(e.staleDescription):"".concat(e.description)})})))};Le.propTypes={data:k().object};var Ue=function(e){var t=e.id,n=e.title,r=e.description,o=e.iconPath,a=e.iconScale,i=e.fillColor;return S().createElement(K.Dl,{key:t},S().createElement(K.Dt,null,S().createElement(xe.G7,{style:{display:"flex",flexDirection:"row"}},o?S().createElement(Ie,{iconPath:o,iconScale:a,fillColor:i}):null,S().createElement(xe.xv,null,n))),S().createElement(K.Dd,null,r))};Ue.propTypes={id:k().string,title:k().string,description:k().string,iconPath:k().string,iconScale:k().number,fillColor:k().string};var Me=function(){return S().createElement(O.Fragment,{key:"second-page"},S().createElement(xe.xv,{style:Se.execHeading},"Description of states"),ue.map((function(e,t){return S().createElement(Ue,{key:"".concat(t,"-").concat(e.title),id:e.title,title:e.title,description:e.description,iconPath:e.iconPath,iconScale:e.iconScale,fillColor:e.fillColor})})),S().createElement(xe.xv,{style:Se.execHeading},"Description of conditions"),pe.map((function(e,t){return S().createElement(Ue,{key:"".concat(t,"-").concat(e.title),id:e.title,title:e.title,description:e.description})})))};function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=function(e){var t=e.isDisabled,n=(0,O.useState)(!1),r=V()(n,2),o=r[0],a=r[1],s=(0,T.I0)(),l=se,u=ce,p=le,d=function(){var e=c()(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(!0),s((0,De.wN)(l)),e.next=5,(0,de.Q5)();case 5:return t=e.sent,s((0,De.L1)()),s((0,De.wN)(u)),a(!1),e.abrupt("return",[S().createElement(Be,{key:"executive-first-page",data:t}),S().createElement(Le,{key:"executive-second-page",data:t}),S().createElement(Me,{key:"executive-third-page"})]);case 12:e.prev=12,e.t0=e.catch(0),s((0,De.L1)()),s((0,De.wN)(p));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return S().createElement(O.Fragment,null,S().createElement(K.o6,{label:o?"Loading...":"Download executive report",reportName:"Resource optimization service report",type:"",fileName:"Resource-Optimization-Executive-Report--".concat((new Date).toISOString().replace(/[T:]/g,"-").split(".")[0],"-utc.pdf"),size:"A4",allPagesHaveTitle:!1,asyncFunction:function(){return d()},buttonProps:Ge({variant:"link",component:"a",icon:S().createElement(Te.ZP,{className:"iconOverride"}),className:"downloadButtonOverride",isAriaDisabled:t},o?{isDisabled:!0}:null),ErrorComponent:function(e){return S().createElement("div",null,S().createElement("h2",null," Error while loading executive report "),(null==e?void 0:e.message)&&S().createElement("p",null,e.message))}}))};function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}qe.propTypes={isDisabled:k().bool};var Ye=function(e){y()(m,e);var t,n,r,a,s,l,p=(s=m,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b()(s);if(l){var n=b()(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v()(this,e)});function m(e){var t;return u()(this,m),t=p.call(this,e),x()(f()(t),"updateStateFilter",(function(e){t.setState({stateFilterValue:e})})),x()(f()(t),"updateOSFilter",(function(e){t.setState({osFilterValue:e})})),x()(f()(t),"onDeleteFilters",(function(e,n){var r=n.filter((function(e){return"State"===e.category})),o=n.filter((function(e){return"Operating System"===e.category}));if(r.length>0){var a;t.clearStateQueryParams();var i=null===(a=r[0])||void 0===a?void 0:a.chips.map((function(e){return null==e?void 0:e.name})),s=t.state.stateFilterValue.filter((function(e){return!i.includes(e)}));t.setState({stateFilterValue:s})}if(o.length>0){var c,l=null===(c=o[0])||void 0===c?void 0:c.chips.map((function(e){return null==e?void 0:e.name})),u=t.state.osFilterValue.filter((function(e){return!l.includes(e)}));t.setState({osFilterValue:u})}})),x()(f()(t),"getActiveFilterConfig",(function(){var e=t.state.stateFilterValue.map((function(e){return{name:e}})),n=t.state.osFilterValue.map((function(e){return{name:e}})),r=[];return e.length>0&&r.push({category:"State",chips:e}),n.length>0&&r.push({category:"Operating System",chips:n}),r})),x()(f()(t),"setColumnModalOpen",(function(e){t.setState({isColumnModalOpen:e})})),x()(f()(t),"getActiveColumns",(function(){return t.props.columns.filter((function(e){return e.isChecked}))})),t.state={perPage:10,orderBy:"report_date",orderDirection:j.SortByDirection.desc,stateFilterValue:[],isColumnModalOpen:!1,exportSystemsPDF:!1,nameFilterValue:"",disableExport:!0,osFilterValue:[],OSFObject:{}},t.sortingHeader={display_name:"display_name",os:"os","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state",report_date:"report_date"},t.chunkSize=50,t.inventory=S().createRef(),t.fetchSystems=t.fetchSystems.bind(f()(t)),t}return d()(m,[{key:"componentDidMount",value:(a=c()(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Resource Optimization - Red Hat Insights",null===(t=insights.chrome)||void 0===t||null===(n=t.hideGlobalFilter)||void 0===n||n.call(t,!0),insights.chrome.appAction("ros-systems"),e.next=5,this.props.isROSConfigured();case 5:this.processQueryParams(),this.processOsVersion();case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"processQueryParams",value:function(){var e=this.props.location,t=new URLSearchParams(e.search),n=t.get(A.Q0);"true"===t.get(A.H7)?this.setState({stateFilterValue:["Waiting for data"]}):"true"===n&&this.setState({stateFilterValue:["Undersized","Oversized","Under pressure","Idling"]})}},{key:"processOsVersion",value:function(){var e=this,t={label:"Operating system",type:"checkbox",filterValues:{}};this.fetchSystems({perPage:-1}).then((function(n){t.filterValues.items=Array.from(new Set(n.data.reduce((function(e,t){return t.os&&e.push(t.os),e}),[]))).map((function(e){return{label:e,value:e.split(" ")[1]}})),e.setState({OSFObject:t})}))}},{key:"clearStateQueryParams",value:function(){var e=this.props.location,t=new URL(window.location),n=new URLSearchParams(e.search),r=n.get(A.Q0);(n.get(A.H7)||r)&&(n.delete(A.Q0),n.delete(A.H7),window.history.replaceState(null,"","".concat(t.origin).concat(t.pathname,"?").concat(n.toString()).concat(window.location.hash)))}},{key:"fetchSystems",value:(r=c()(i().mark((function e(t){var n,r,o,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return a=We({limit:t.perPage,offset:(t.page-1)*t.perPage,order_by:t.orderBy||this.state.orderBy,order_how:t.orderHow||this.state.orderDirection},(null==t||null===(n=t.filters)||void 0===n?void 0:n.hostnameOrId)&&{display_name:t.filters.hostnameOrId}),s=new URL(A.RC+A.M4,window.location.origin),c=new URLSearchParams(a),null==t||null===(r=t.stateFilter)||void 0===r||r.forEach((function(e){c.append("state",e)})),null==t||null===(o=t.osFilter)||void 0===o||o.forEach((function(e){c.append("os",e)})),s.search=c.toString(),e.abrupt("return",fetch(s).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"chunkIdsArray",value:function(e){for(var t=[];e.length;)t.push(e.splice(0,this.chunkSize));return t}},{key:"fetchInventoryDetails",value:(n=c()(i().mark((function e(t,n){var r,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!(n.per_page>50&&t.length>50)){e.next=8;break}return e.next=4,this.multipleGetEntitiesRequests(t,n);case 4:e.sent.map((function(e){var t;(t=r).push.apply(t,o()(e))})),e.next=12;break;case 8:return e.next=10,null===(a=(s=this.state).getEntities)||void 0===a?void 0:a.call(s,t,n,!1);case 10:c=e.sent,r=c.results;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"multipleGetEntitiesRequests",value:(t=c()(i().mark((function e(t,n){var r,o=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.chunkIdsArray(t),e.abrupt("return",Promise.all(r.map(function(){var e=c()(i().mark((function e(t){var r,a,s,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=(a=o.state).getEntities)||void 0===r?void 0:r.call(a,t,n,!1);case 2:return s=e.sent,c=s.results,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){return e})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setExportSystemsPDF",value:function(e){this.setState({exportSystemsPDF:e})}},{key:"onExportOptionSelect",value:function(e){var t=this.state,n=t.stateFilterValue,r=t.nameFilterValue,o=t.osFilterValue,a=t.orderBy,i=t.orderDirection,s={stateFilter:n,hostnameOrId:r,osFilter:o},c=this.props,l=c.addNotification,u=c.clearNotifications;je(e,s,a,i,(function(e){return l(e)}),(function(){return u()}))}},{key:"renderConfigStepsOrTable",value:function(){var e,t=this,n=A.N7.state,r=this.getActiveColumns(),o=this.state,a=o.exportSystemsPDF,s=o.stateFilterValue,l=o.nameFilterValue,u=o.osFilterValue,p=o.orderBy,d=o.orderDirection,m=o.disableExport,f=o.isColumnModalOpen,h=o.OSFObject;return this.props.showConfigSteps?S().createElement(H.v,null):S().createElement(R.Card,{className:"pf-t-light  pf-m-opaque-100"},S().createElement(R.CardBody,null,S().createElement(Q,{isModalOpen:f,setModalOpen:this.setColumnModalOpen,modalColumns:this.props.columns,saveColumns:function(e){return t.props.changeSystemColumns({columns:e})}}),S().createElement(z.Z,{disableDefaultColumns:!0,ref:this.inventory,hasCheckbox:!1,tableProps:{canSelectAll:!1,className:"ros-systems-table"},variant:"compact",hideFilters:{all:!0,name:!1},autoRefresh:!0,customFilters:{stateFilter:s,osFilter:u},columns:r,getEntities:function(){var e=c()(i().mark((function e(n,r){var o,a,s,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState((function(){var e;return{orderBy:r.orderBy,orderDirection:r.orderDirection,nameFilterValue:null===(e=r.filters)||void 0===e?void 0:e.hostnameOrId}})),e.next=3,t.fetchSystems({page:r.page,perPage:r.per_page,orderBy:t.sortingHeader[r.orderBy],orderHow:r.orderDirection,filters:r.filters,stateFilter:r.stateFilter,osFilter:r.osFilter});case 3:return a=e.sent,s=(a.data||[]).map((function(e){return e.inventory_id})),e.next=7,t.fetchInventoryDetails(s,We(We({},r),{},{orderBy:void 0,orderDirection:void 0,page:1,hasItems:!0}));case 7:return c=e.sent,l=0===(null==a||null===(o=a.meta)||void 0===o?void 0:o.count),t.setState((function(){return{disableExport:l}})),e.abrupt("return",{results:a.data.map((function(e){var t=c.find((function(t){return t.id===e.inventory_id}));return We(We(We({},t),t?{isDeleted:!1}:{id:e.inventory_id,isDeleted:!0}),e)})),total:a.meta.count,page:r.page,per_page:r.per_page});case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),onLoad:function(e){var n=e.mergeWithEntities,r=e.INVENTORY_ACTION_TYPES,o=e.api;t.setState({getEntities:null==o?void 0:o.getEntities}),(0,I.z2)(We({},n((0,B.zw)(r,A.XY)))),t.props.setSort(p,d,"CHANGE_SORT")},expandable:"true",filterConfig:{items:[{label:n.label,type:n.type,value:"checkbox-state",filterValues:{items:n.filterValues.items,onChange:function(e,n){return t.updateStateFilter(n)},value:s}},{label:h.label,type:h.type,value:"checkbox-os",filterValues:{items:null===(e=h.filterValues)||void 0===e?void 0:e.items,onChange:function(e,n){return t.updateOSFilter(n)},value:u}}]},activeFiltersConfig:{filters:this.getActiveFilterConfig(),onDelete:this.onDeleteFilters},actionsConfig:{actions:["",{label:"Manage columns",onClick:function(){return t.setColumnModalOpen(!0)}}]},exportConfig:{isDisabled:m,extraItems:[S().createElement("li",{key:"pdf-button-item",role:"menuitem"},S().createElement(R.Button,{key:"pdf-download-button",variant:"none",className:"pf-c-dropdown__menu-item",onClick:function(){return t.setExportSystemsPDF(!0)}},"Export to PDF"))],ouiaId:"export",onSelect:function(e,n){return t.onExportOptionSelect(n)}},onExpandClick:function(e,n,r,o){var a=o.id;return t.props.expandRow(a,r,"EXPAND_ROW")}}),a&&S().createElement(Fe,{showButton:!1,onSuccess:function(){return t.setExportSystemsPDF(!1)},filters:{stateFilter:s,hostnameOrId:l,osFilter:u},orderBy:p,orderHow:d})))}},{key:"render",value:function(){var e=this;return S().createElement(S().Fragment,null,S().createElement(P.Z,{className:"ros-page-header"},S().createElement(D.Z,{title:"Resource Optimization"}),S().createElement(qe,{isDisabled:this.state.disableExport})),S().createElement(F.Z,null,S().createElement(L.B.Consumer,null,(function(t){return!1===t.permissions.systemsRead?S().createElement(U.Z,{serviceName:"Resource Optimization"}):e.renderConfigStepsOrTable()}))))}}]),m}(S().Component);Ye.propTypes={expandRow:k().func,setSort:k().func,isROSConfigured:k().func,showConfigSteps:k().bool,location:k().object,columns:k().array,changeSystemColumns:k().func,addNotification:k().func,clearNotifications:k().func};const Ze=(0,_.withRouter)((0,T.$j)((function(e,t){var n;return We({showConfigSteps:null===(n=e.isConfiguredReducer)||void 0===n?void 0:n.showConfigSteps,columns:e.systemColumnsReducer.columns},t)}),(function(e){return{expandRow:function(t,n,r){return e({type:r,payload:{id:t,isOpen:n}})},setSort:function(t,n,r){return e({type:r,payload:{key:t,direction:n}})},isROSConfigured:function(){return e((0,N.Pn)())},changeSystemColumns:function(t){return e((0,N.zz)(t))},addNotification:function(t){return e((0,De.wN)(t))},clearNotifications:function(){return e((0,De.L1)())}}}))(Ye))},30859:(e,t,n)=>{"use strict";n.d(t,{jL:()=>f,S7:()=>h,x2:()=>y,lc:()=>g,tp:()=>v,Q5:()=>E});var r=n(87757),o=n.n(r),a=n(48926),i=n.n(a),s=n(59713),c=n.n(s),l=n(88587),u=n(58061);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){if(!e.ok)throw Error(e.statusText);return e}var f=function(){var e=new URL(u.RC+u.LO,window.location.origin);return window.insights.chrome.auth.getUser().then((function(){return fetch(e).then(m).then((function(e){return e.json()})).then((function(e){return e}))}))},h=function(e){var t=new URL(u.RC+u.M4+"/".concat(e),window.location.origin);return window.insights.chrome.auth.getUser().then((function(){return fetch(t).then(m).then((function(e){return e.json()})).then((function(e){return e}))}))},y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={limit:t.perPage,offset:(t.page-1)*t.perPage};t.description&&t.description.trim()&&(n=d(d({},n),{},{description:t.description}));var r=new URL(u.RC+u.M4+"/".concat(e,"/suggestions"),window.location.origin);r.search=new URLSearchParams(n).toString();var o=window.insights.chrome.auth.getUser().then((function(){return fetch(r).then((function(e){if(!e.ok&&404===e.status)return{hasError:!0};if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return e}))}));return o},g=function(){var e=i()(o().mark((function e(t){var n,r,a,i,s,c,p,m,f,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return s=(i=t||{}).perPage,c=i.orderBy,p=i.orderHow,m=d(d({order_by:{display_name:"display_name",os:"os","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state",report_date:"report_date"}[c]||"report_date",order_how:p||l.SortByDirection.desc,limit:s||-1},(null==t?void 0:t.page)&&{offset:(t.page-1)*t.perPage}),(null==t||null===(n=t.filters)||void 0===n?void 0:n.hostnameOrId)&&{display_name:t.filters.hostnameOrId}),f=new URL(u.RC+u.M4,window.location.origin),h=new URLSearchParams(m),null==t||null===(r=t.stateFilter)||void 0===r||r.forEach((function(e){h.append("state",e)})),null==t||null===(a=t.osFilter)||void 0===a||a.forEach((function(e){h.append("os",e)})),f.search=h.toString(),e.abrupt("return",fetch(f).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e,t){var n=new URL("".concat(u.RC).concat(u.M4,"/").concat(e,"/history"),window.location.origin),r=new URLSearchParams({limit:t});return n.search=r.toString(),window.insights.chrome.auth.getUser().then((function(){return fetch(n).then(m).then((function(e){return e.json()})).then((function(e){return e}))}))},E=function(){var e=i()(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return t=new URL("".concat(u.RC).concat(u.v2),window.location.origin),e.abrupt("return",fetch(t).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},94778:(e,t,n)=>{"use strict";n.d(t,{Of:()=>o,t9:()=>a,Pn:()=>i,zz:()=>s});var r=n(30859),o=function(e){return{type:"LOAD_ROS_SYSTEM_INFO",payload:(0,r.S7)(e)}},a=function(e,t){return{type:"FETCH_SYSTEM_RECOMMENDATIONS_LIST",payload:(0,r.x2)(e,t)}},i=function(){return{type:"LOAD_IS_CONFIGURED_INFO",payload:(0,r.jL)()}},s=function(e){return{type:"CHANGE_SYSTEM_COLUMNS",payload:e}}},42480:()=>{},19527:()=>{},69331:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=../sourcemaps/RosPage.66a76dc8863419138635c99b6575697b.js.map