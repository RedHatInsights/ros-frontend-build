(self.webpackChunkros_frontend=self.webpackChunkros_frontend||[]).push([[821],{3955:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var r=n(45103),o=n(2112),i=n(43297),a=n.n(i),s=n(58061),c=function(){return a().createElement(r.Bullseye,null,a().createElement(r.EmptyState,{className:"empty-state-not-configured"},a().createElement(r.EmptyStateIcon,{icon:o.ZP}),a().createElement(r.Title,{headingLevel:"h5",size:"lg"},"Resource optimization isn't configured yet"),a().createElement(r.EmptyStateBody,null,a().createElement(r.Bullseye,null,a().createElement(r.Stack,{hasGutter:!0},a().createElement(r.StackItem,null,"Resource Optimization requires installing and configuring Performance Co-Pilot on the client system."),a().createElement(r.StackItem,null,"Check the documentation to find how to configure Resource Optimization with Ansible. An alternative method which does not require Ansible is also described."),a().createElement(r.StackItem,null,"After configuring Resource Optimization, it may take up to 24 hours until suggestions are available.")))),a().createElement(r.Button,{component:"a",href:s.wy,target:"_blank",variant:"primary"},"Getting started documentation")))}},31187:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ie});var r=n(319),o=n.n(r),i=n(87757),a=n.n(i),s=n(48926),c=n.n(s),l=n(34575),u=n.n(l),p=n(93913),d=n.n(p),f=n(81506),m=n.n(f),h=n(2205),g=n.n(h),y=n(78585),v=n.n(y),w=n(29754),E=n.n(w),b=n(59713),S=n.n(b),O=n(43297),x=n.n(O),C=n(45697),k=n.n(C),P=n(16530),D=n(80123),F=n(39173),_=n(14748),R=n(45103),j=n(88587),T=n(2983),z=n(33739),I=n(30319),N=n(70702),B=n(94778),A=n(58061),L=n(3955),M=n(87999),U=n(85333),H=n(63038),V=n.n(H);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=e.modalColumns,n=e.isModalOpen,r=e.setModalOpen,i=e.saveColumns,a=(0,O.useState)(t),s=V()(a,2),c=s[0],l=s[1],u=function(){r(!1),l(t)};return x().createElement(R.Modal,{title:"Manage columns",onClose:u,isOpen:n,variant:"small",description:x().createElement(R.TextContent,null,x().createElement(R.Text,{component:R.TextVariants.p},"Selected categories will be displayed in the table"),x().createElement(R.Split,{hasGutter:!0},x().createElement(R.SplitItem,null,x().createElement(R.Button,{isInline:!0,onClick:function(){l(c.map((function(e){return q(q({},e),{},{isChecked:!0})})))},variant:"link"},"Select all")),x().createElement(R.SplitItem,null,x().createElement(R.Button,{isInline:!0,onClick:function(){l(c.map((function(e){var t;return q(q({},e),{},{isChecked:null!==(t=e.isShownByDefault)&&void 0!==t&&t})})))},variant:"link"},"Reset to default")))),actions:[x().createElement(R.Button,{key:"save",variant:"primary",onClick:function(){r(!1),i(c)}},"Save"),x().createElement(R.Button,{key:"cancel",variant:"secondary",onClick:u},"Cancel")]},x().createElement(R.DataList,{"aria-label":"Column management table",id:"column-management-table",isCompact:!0},c.map((function(e,t){return x().createElement(R.DataListItem,{key:e.key},x().createElement(R.DataListItemRow,null,x().createElement(R.DataListCheck,{checked:e.isChecked,id:"checkbox-".concat(t),onChange:function(){return function(e){var t=o()(c),n=q({},t[e]);n.isChecked=!n.isChecked,t[e]=n,l(t)}(t)},isDisabled:e.isDisabled}),x().createElement(R.DataListItemCells,{dataListCells:[x().createElement(R.DataListCell,{key:"column-table-item-".concat(t)},x().createElement("label",null,e.modalTitle))]})))}))))};Q.propTypes={modalColumns:k().arrayOf(k().object).isRequired,isModalOpen:k().bool.isRequired,setModalOpen:k().func.isRequired,saveColumns:k().func.isRequired};var Y=n(67154),Z=n.n(Y),$=n(6479),W=n.n($),X=n(3968),J=n(30859),K=n(27361),ee=n.n(K),te=n(39371),ne=function(e,t){var n=[],r="json"===t?A.Jd:A._0;return e.map((function(e){var o="json"===t?{}:[];r.map((function(n){var r=ee()(e,n,"");r="N/A"!==(r=null===r||-1===r?"N/A":r.toString())&&A.BX.includes(n)?"".concat(r,"%"):r,r="report_date"===n?(0,te.dateStringByType)("exact")(new Date(r)):r,"json"===t?o[n]=r:"pdf"===t&&o.push(r)})),n.push(o)})),n},re=function(e){var t=ne(e,"json");return JSON.stringify(t)},oe=function(e){var t=ne(e,"json"),n=Object.keys(t[0]);return[n.join(",")].concat(o()(t.map((function(e){return n.map((function(t){return e[t]})).join(",")})))).join("\r\n")},ie=function(e){var t,n,r,o="",i="\n",a=(null==e||null===(t=e.stateFilter)||void 0===t?void 0:t.length)>0,s=(null==e||null===(n=e.hostnameOrId)||void 0===n?void 0:n.length)>0,c=(null==e||null===(r=e.osFilter)||void 0===r?void 0:r.length)>0;return(a||s||c)&&(o="".concat(i,"Filters applied").concat(i),o=s?o.concat("Name: ".concat(e.hostnameOrId).concat(i)):o,o=a?o.concat("State: ".concat(e.stateFilter.toString()).concat(i)):o,o=c?o.concat("Operating System: ".concat(e.osFilter.sort().toString()).concat(i)):o),o},ae=function(){var e="".concat((new Date).toISOString().replace(/[T:]/g,"-").split(".")[0],"-utc");return"".concat(A.rv).concat(e)},se=n(69748);const ce=se.mM.create({bodyCell:{textAlign:"left",fontSize:8,paddingBottom:2,paddingTop:2,paddingRight:2,flex:1},headerCell:{textAlign:"left",fontSize:8,flex:1},systemNameCell:{textAlign:"left",fontSize:8,flex:2.5,paddingBottom:2,paddingTop:2,paddingRight:2},lastReportedCell:{textAlign:"left",fontSize:8,flex:1.2,paddingBottom:2,paddingTop:2,paddingRight:2},headerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-around"},rowStyle:{display:"flex",flexDirection:"row",justifyContent:"center"},execHeading:{textAlign:"left",fontSize:10,color:"#C9190B",marginBottom:4,marginTop:10},occuranceHeading:{textAlign:"left",fontSize:10,color:"#C9190B",marginTop:12,marginBottom:-4},execInfoText:{flex:1,textAlign:"right",fontSize:6}});var le=function(e){var t=e.value,n=e.style,r=e.key;return x().createElement(se.xv,{key:r,style:n},t)},ue=["Name","OS","CPU utilization","Memory utilization","I/O utilization","Suggestions","State","Last reported"],pe=function(e){var t=e.data,n=e.page,r=ue.map((function(e,t){var n="Name"===e?[ce.systemNameCell]:"Last reported"===e?[ce.lastReportedCell]:[ce.headerCell];return le({value:e,style:n,key:"".concat(t,"-").concat(e)})})),i=t.map((function(e){return e.map((function(e,t){var n=ue.indexOf("Name"),r=ue.indexOf("Last reported"),o=t===n?[ce.systemNameCell]:t===r?[ce.lastReportedCell]:[ce.bodyCell];return le({value:e,style:o,key:"".concat(t,"-").concat(e)})}))}));return x().createElement(O.Fragment,{key:n},x().createElement(X.$0,null,x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:[r].concat(o()(i))}))))};pe.propTypes={data:k().array,page:k().number},le.propTypes={value:k().string,style:k().array,key:k().string};var de=function(e){var t=e.data,n=e.totalSystems,r=e.filterText;return x().createElement(O.Fragment,{key:"first-section"},x().createElement(X.$0,null,x().createElement(X.sg,null,"This report identified ".concat(n," ").concat(n>1?"RHEL systems":"RHEL system",". ").concat(r))),x().createElement(pe,{data:t,page:0}))};de.propTypes={data:k().array,totalSystems:k().number,filterText:k().string};var fe=n(83215),me=function(e){var t=e.filters,n=e.orderBy,r=e.orderHow,i=W()(e,["filters","orderBy","orderHow"]),s=ae(),l=(0,T.I0)(),u=A._M.start,p=A._M.success,d=A._M.failure;(0,O.useEffect)((function(){l((0,fe.wN)(u))}),[]);var f=function(){var e=c()(a().mark((function e(t,n,r){var i,s,c,u,f,m,h,g,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=A.aA.firstPageCount,u=A.aA.otherPageCount,f={filters:t,stateFilter:t.stateFilter,osFilter:t.osFilter,orderBy:n,orderHow:r},e.prev=2,e.next=5,(0,J.lc)(f);case 5:m=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),l((0,fe.L1)()),l((0,fe.wN)(d)),e.abrupt("return",[]);case 13:for(h=ne(m.data,"pdf"),g={data:h.splice(0,c),totalSystems:null===(i=m)||void 0===i||null===(s=i.meta)||void 0===s?void 0:s.count,filterText:ie(t)},y=[];h.length>0;)y.push(h.splice(0,u));return l((0,fe.L1)()),l((0,fe.wN)(p)),e.abrupt("return",[x().createElement(de,Z()({key:"first-page"},g))].concat(o()(y.map((function(e,t){return x().createElement(pe,{key:t,data:e,page:t+1})})))));case 20:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,r){return e.apply(this,arguments)}}();return x().createElement("div",null,x().createElement(X.o6,Z()({},i,{reportName:A.AC,type:"",fileName:"".concat(s,".pdf"),size:"A4",orientation:"landscape",allPagesHaveTitle:!1,asyncFunction:function(){return f(t,n,r)}})))};me.propTypes={filters:k().object,orderBy:k().string,orderHow:k().string};var he=n(1284),ge=function(){var e=c()(a().mark((function e(t,n,r,o,i,s){var c,l,u,p,d,f,m;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=ae(),l=A._M.start,u=A._M.success,p=A._M.failure,i(l),d={filters:n,stateFilter:n.stateFilter,osFilter:n.osFilter,orderBy:r,orderHow:o},e.prev=4,e.next=7,(0,J.lc)(d);case 7:f=e.sent,m="json"===t?re(f.data):oe(f.data),(0,he.downloadFile)(m,c,t),s(),i(u),e.next=19;break;case 14:throw e.prev=14,e.t0=e.catch(4),s(),i(p),"".concat(e.t0);case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t,n,r,o,i,a){return e.apply(this,arguments)}}(),ye=n(1657),ve=n(11676),we=function(e){var t=e.width,n=void 0===t?15:t,r=e.height,o=void 0===r?10:r,i=e.padding,a=void 0===i?2:i,s=e.iconScale,c=void 0===s?.014:s,l=e.iconPath,u=void 0===l?ve.DK.svgPath:l,p=e.fillColor,d=void 0===p?"#8BC1F7":p;return x().createElement(se.Xz,{style:{width:n,height:o,padding:a},paint:function(e){var t=e.path;(0,e.scale)(c),t(u).fill(d)}})};we.propTypes={width:k().number,height:k().number,padding:k().number,iconScale:k().number,iconPath:k().string,fillColor:k().string};var Ee=function(e){var t,n,r=e.data,i=null==r?void 0:r.meta,a=i.conditions_count,s=i.non_optimized_count,c=i.total_count,l=null==r||null===(t=r.systems_per_state)||void 0===t||null===(n=t.optimized)||void 0===n?void 0:n.count,u="•",p=[[x().createElement(se.G7,{key:"disk-io-title",style:{display:"flex",flexDirection:"row"}},x().createElement(we,{fillColor:"#8BC1F7"}),x().createElement(se.xv,null,"Disk I/O"))]],d=[[x().createElement(se.G7,{key:"memory-title",style:{display:"flex",flexDirection:"row"}},x().createElement(we,{fillColor:"#002F5D"}),x().createElement(se.xv,null,"RAM"))]],f=[[x().createElement(se.G7,{key:"cpu-title",style:{display:"flex",flexDirection:"row"}},x().createElement(we,{fillColor:"#0066CC"}),x().createElement(se.xv,null,"CPU"))]],m=function(e){var t=e.systems_per_state,n=e.conditions,r=[],o=[["# of systems"]],i=[],a=[["# of occurrences"]],s={io:{name:"Disk IO",occurances:[]},memory:{name:"RAM",occurances:[]},cpu:{name:"CPU",occurances:[]}},c={idling:"Idling",oversized:"Oversized",under_pressure:"Under pressure",undersized:"Undersized",waiting_for_data:"Waiting for data",optimized:"Optimized"};return Object.keys(t).map((function(e){var n,i,a=c[e],s=null===(n=t[e])||void 0===n?void 0:n.percentage,l=null===(i=t[e])||void 0===i?void 0:i.count;r.push({x:a,y:s}),o.push(["".concat(l," (").concat(s,"% of total)")])})),Object.keys(n).map((function(e){var t,r,o=s[e].name,c=Math.floor(null===(t=n[e])||void 0===t?void 0:t.percentage),l=null===(r=n[e])||void 0===r?void 0:r.count;i.push({x:o,y:c}),a.push(["".concat(l)]);var u=null!==n[e].under_pressure?n[e].under_pressure:0,p=null!==n[e].undersized?n[e].undersized:0,d=null!==n[e].oversized?n[e].oversized:0;s[e].occurances.push(["Under pressure","".concat(u)]),-1!==p&&-1!==d&&(s[e].occurances.push(["Undersized","".concat(p)]),s[e].occurances.push(["Oversized","".concat(d)]))})),{stateChartData:r,stateTableData:o,conditionsChartData:i,conditionsTableData:a,condtionsInfo:s}}(r),h=m.stateChartData,g=m.stateTableData,y=m.conditionsChartData,v=m.conditionsTableData,w=m.condtionsInfo;return p.push.apply(p,o()(w.io.occurances)),d.push.apply(d,o()(w.memory.occurances)),f.push.apply(f,o()(w.cpu.occurances)),x().createElement(O.Fragment,{key:"first-page"},x().createElement(se.xv,null,"This executive summary highlights the performance for your registered systems included in the resource optimization service."),x().createElement(se.xv,null,"This report gives you an overview of:".concat("\n")),x().createElement(se.xv,null,"".concat(u," The number of systems registered\n                ").concat(u," Number of registered systems in a non-optimal state\n                ").concat(u," Number of system performance issues\n                ").concat(u," Description of system performance levels\n                ").concat(u," Performance level details for system resources operating in a non-optimal state")),x().createElement(se.xv,{style:ce.execHeading},"Registered systems"),x().createElement(se.xv,null,"There are ".concat(c," systems registered in the resource optimization service. The service identified ").concat(l," of ").concat(c," systems as optimized, and ").concat(s," of ").concat(c," registered systems as having a non-optimal state.")),x().createElement(se.xv,{style:ce.execHeading},"Breakdown of registered systems"),x().createElement(X.$0,null,x().createElement(X.sg,null,x().createElement(X.kL,{chartType:"pie",subTitle:"Non-optimal",title:s,data:h,colorSchema:"multi",legendHeader:"State",showLabels:!1,labels:function(){return""}})),x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:g}))),x().createElement(se.xv,{style:ce.execInfoText},"Description of states are on the second page of the report*"),x().createElement(se.xv,{style:ce.execHeading},"System performance issues"),x().createElement(se.xv,null,"There are ".concat(a," system performance issues.")),x().createElement(X.$0,null,x().createElement(X.sg,null,x().createElement(X.kL,{chartType:"donut",subTitle:"Conditions",title:a,data:y,colorSchema:"blue",legendHeader:"Conditions",showLabels:!1})),x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:v}))),x().createElement(se.xv,{style:ce.occuranceHeading},"Breakdown of occurences"),x().createElement(X.$0,null,x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:p})),x().createElement(X.sg,{style:{flex:.2}}),x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:d})),x().createElement(X.sg,{style:{flex:.2}}),x().createElement(X.sg,null,x().createElement(X.iA,{withHeader:!0,rows:f}))),x().createElement(se.xv,{style:ce.execInfoText},"Under pressure conditions are only reported for systems where Kernel Pressure Stall Information is enabled. Check the documentation for details.*"),x().createElement(se.xv,{style:ce.execInfoText},"Description of conditions are on the second page of the report*"))};Ee.propTypes={data:k().object};var be=n(58773),Se=n(5381),Oe=n(2293),xe=n(82727),Ce=n(18802),ke=n(35451),Pe=function(e){var t=e.key,n=e.title,r=e.description,o=e.iconPath,i=e.iconScale,a=e.fillColor;return x().createElement(X.Dl,{key:t},x().createElement(X.Dt,null,x().createElement(se.G7,{style:{display:"flex",flexDirection:"row"}},o?x().createElement(we,{iconPath:o,iconScale:i,fillColor:a}):null,x().createElement(se.xv,null,n))),x().createElement(X.Dd,null,r))};Pe.propTypes={key:k().string,title:k().string,description:k().string,iconPath:k().string,iconScale:k().number,fillColor:k().string};var De=function(){var e=[{title:"Optimized",description:"Performing at an optimal level",iconPath:ke.GR.svgPath,iconScale:.014,fillColor:"green"},{title:"Under pressure",description:"Peaking occasionally",iconPath:be.wP.svgPath,iconScale:.014,fillColor:"#030303"},{title:"Undersized",description:"Using more than 80% of system resources",iconPath:Se.MA.svgPath,iconScale:.014,fillColor:"red"},{title:"Oversized",description:"Using less than 20% of system resources",iconPath:Oe.zN.svgPath,iconScale:.014,fillColor:"#f09800"},{title:"Idling",description:"Consuming less than 5% of resources",iconPath:xe.hh.svgPath,iconScale:.008,fillColor:"#030303"},{title:"Waiting for data",description:"Data has not been received or is being processed. Initial data processing takes up to 24 hours.",iconPath:Ce.Y3.svgPath,iconScale:.008,fillColor:"#2B9AF3"}];return x().createElement(O.Fragment,{key:"second-page"},x().createElement(se.xv,{style:ce.execHeading},"Description of states"),e.map((function(e){return x().createElement(Pe,{key:e.title,title:e.title,description:e.description,iconPath:e.iconPath,iconScale:e.iconScale,fillColor:e.fillColor})})),x().createElement(se.xv,{style:ce.execHeading},"Description of conditions"),[{title:"CPU pressure",description:"CPU registered peaks higher than 20% over several one-minute time periods"},{title:"Disk I/O  pressure",description:"Disk I/O registered peaks higher than 20% over several one-minute time periods"},{title:"RAM pressure",description:"RAM registered peaks higher than 20% over several one-minute time periods"}].map((function(e){return x().createElement(Pe,{key:e.title,title:e.title,description:e.description})})))};function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=function(e){var t=e.isDisabled,n=(0,O.useState)(!1),r=V()(n,2),o=r[0],i=r[1],s=(0,T.I0)(),l=A._M.start,u=A._M.success,p=A._M.failure,d=function(){var e=c()(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i(!0),s((0,fe.wN)(l)),e.next=5,(0,J.Q5)();case 5:return t=e.sent,s((0,fe.L1)()),s((0,fe.wN)(u)),i(!1),e.abrupt("return",[x().createElement(Ee,{key:"executive-first-page",data:t}),x().createElement(De,{key:"executive-second-page"})]);case 12:e.prev=12,e.t0=e.catch(0),s((0,fe.L1)()),s((0,fe.wN)(p));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return x().createElement(O.Fragment,null,x().createElement(X.o6,{label:o?"Loading...":"Download executive report",reportName:"Resource optimization service report",type:"",fileName:"Resource-Optimization-Executive-Report--".concat((new Date).toISOString().replace(/[T:]/g,"-").split(".")[0],"-utc.pdf"),size:"A4",allPagesHaveTitle:!1,asyncFunction:function(){return d()},buttonProps:_e({variant:"link",component:"a",icon:x().createElement(ye.ZP,{className:"iconOverride"}),className:"downloadButtonOverride",isAriaDisabled:t},o?{isDisabled:!0}:null)}))};function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Re.propTypes={isDisabled:k().bool};var ze=function(e){g()(f,e);var t,n,r,i,s,l,p=(s=f,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E()(s);if(l){var n=E()(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v()(this,e)});function f(e){var t;return u()(this,f),t=p.call(this,e),S()(m()(t),"updateStateFilter",(function(e){t.setState({stateFilterValue:e})})),S()(m()(t),"updateOSFilter",(function(e){t.setState({osFilterValue:e})})),S()(m()(t),"onDeleteFilters",(function(e,n){var r=n.filter((function(e){return"State"===e.category})),o=n.filter((function(e){return"Operating System"===e.category}));if(r.length>0){var i;t.clearStateQueryParams();var a=null===(i=r[0])||void 0===i?void 0:i.chips.map((function(e){return null==e?void 0:e.name})),s=t.state.stateFilterValue.filter((function(e){return!a.includes(e)}));t.setState({stateFilterValue:s})}if(o.length>0){var c,l=null===(c=o[0])||void 0===c?void 0:c.chips.map((function(e){return null==e?void 0:e.name})),u=t.state.osFilterValue.filter((function(e){return!l.includes(e)}));t.setState({osFilterValue:u})}})),S()(m()(t),"getActiveFilterConfig",(function(){var e=t.state.stateFilterValue.map((function(e){return{name:e}})),n=t.state.osFilterValue.map((function(e){return{name:e}})),r=[];return e.length>0&&r.push({category:"State",chips:e}),n.length>0&&r.push({category:"Operating System",chips:n}),r})),S()(m()(t),"setColumnModalOpen",(function(e){t.setState({isColumnModalOpen:e})})),S()(m()(t),"getActiveColumns",(function(){return t.props.columns.filter((function(e){return e.isChecked}))})),t.state={perPage:10,orderBy:"report_date",orderDirection:j.SortByDirection.desc,stateFilterValue:[],osFilterValue:[],isColumnModalOpen:!1,exportSystemsPDF:!1,nameFilterValue:"",disableExport:!0},t.sortingHeader={display_name:"display_name",os:"os","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state",report_date:"report_date"},t.chunkSize=50,t.inventory=x().createRef(),t.fetchSystems=t.fetchSystems.bind(m()(t)),t}return d()(f,[{key:"componentDidMount",value:(i=c()(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Resource Optimization - Red Hat Insights",null===(t=insights.chrome)||void 0===t||null===(n=t.hideGlobalFilter)||void 0===n||n.call(t,!0),insights.chrome.appAction("ros-systems"),e.next=5,this.props.isROSConfigured();case 5:this.processQueryParams();case 6:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"processQueryParams",value:function(){var e=this.props.location,t=new URLSearchParams(e.search),n=t.get(A.Q0);"true"===t.get(A.H7)?this.setState({stateFilterValue:["Waiting for data"]}):"true"===n&&this.setState({stateFilterValue:["Undersized","Oversized","Under pressure","Idling"]})}},{key:"clearStateQueryParams",value:function(){var e=this.props.location,t=new URL(window.location),n=new URLSearchParams(e.search),r=n.get(A.Q0);(n.get(A.H7)||r)&&(n.delete(A.Q0),n.delete(A.H7),window.history.replaceState(null,"","".concat(t.origin).concat(t.pathname,"?").concat(n.toString()).concat(window.location.hash)))}},{key:"fetchSystems",value:(r=c()(a().mark((function e(t){var n,r,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return i=Te({limit:t.perPage,offset:(t.page-1)*t.perPage,order_by:t.orderBy||this.state.orderBy,order_how:t.orderHow||this.state.orderDirection},(null==t||null===(n=t.filters)||void 0===n?void 0:n.hostnameOrId)&&{display_name:t.filters.hostnameOrId}),s=new URL(A.RC+A.M4,window.location.origin),c=new URLSearchParams(i),null==t||null===(r=t.stateFilter)||void 0===r||r.forEach((function(e){c.append("state",e)})),null==t||null===(o=t.osFilter)||void 0===o||o.forEach((function(e){c.append("os",e)})),s.search=c.toString(),e.abrupt("return",fetch(s).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"chunkIdsArray",value:function(e){for(var t=[];e.length;)t.push(e.splice(0,this.chunkSize));return t}},{key:"fetchInventoryDetails",value:(n=c()(a().mark((function e(t,n){var r,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!(n.per_page>50&&t.length>50)){e.next=8;break}return e.next=4,this.multipleGetEntitiesRequests(t,n);case 4:e.sent.map((function(e){var t;(t=r).push.apply(t,o()(e))})),e.next=12;break;case 8:return e.next=10,null===(i=(s=this.state).getEntities)||void 0===i?void 0:i.call(s,t,n,!1);case 10:c=e.sent,r=c.results;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"multipleGetEntitiesRequests",value:(t=c()(a().mark((function e(t,n){var r,o=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.chunkIdsArray(t),e.abrupt("return",Promise.all(r.map(function(){var e=c()(a().mark((function e(t){var r,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(r=(i=o.state).getEntities)||void 0===r?void 0:r.call(i,t,n,!1);case 2:return s=e.sent,c=s.results,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){return e})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setExportSystemsPDF",value:function(e){this.setState({exportSystemsPDF:e})}},{key:"onExportOptionSelect",value:function(e){var t=this.state,n=t.stateFilterValue,r=t.nameFilterValue,o=t.osFilterValue,i=t.orderBy,a=t.orderDirection,s={stateFilter:n,hostnameOrId:r,osFilter:o},c=this.props,l=c.addNotification,u=c.clearNotifications;ge(e,s,i,a,(function(e){return l(e)}),(function(){return u()}))}},{key:"renderConfigStepsOrTable",value:function(){var e=this,t=A.N7.state,n=A.N7.os,r=this.getActiveColumns(),o=this.state,i=o.exportSystemsPDF,s=o.stateFilterValue,l=o.nameFilterValue,u=o.osFilterValue,p=o.orderBy,d=o.orderDirection,f=o.disableExport;return this.props.showConfigSteps?x().createElement(L.v,null):x().createElement(R.Card,{className:"pf-t-light  pf-m-opaque-100"},x().createElement(R.CardBody,null,x().createElement(Q,{isModalOpen:this.state.isColumnModalOpen,setModalOpen:this.setColumnModalOpen,modalColumns:this.props.columns,saveColumns:function(t){return e.props.changeSystemColumns({columns:t})}}),x().createElement(z.Z,{disableDefaultColumns:!0,ref:this.inventory,hasCheckbox:!1,tableProps:{canSelectAll:!1,className:"ros-systems-table"},variant:"compact",hideFilters:{all:!0,name:!1},autoRefresh:!0,customFilters:{stateFilter:s,osFilter:this.state.osFilterValue},columns:r,getEntities:function(){var t=c()(a().mark((function t(n,r){var o,i,s,c,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState((function(){var e;return{orderBy:r.orderBy,orderDirection:r.orderDirection,nameFilterValue:null===(e=r.filters)||void 0===e?void 0:e.hostnameOrId}})),t.next=3,e.fetchSystems({page:r.page,perPage:r.per_page,orderBy:e.sortingHeader[r.orderBy],orderHow:r.orderDirection,filters:r.filters,stateFilter:r.stateFilter,osFilter:r.osFilter});case 3:return i=t.sent,s=(i.data||[]).map((function(e){return e.inventory_id})),t.next=7,e.fetchInventoryDetails(s,Te(Te({},r),{},{page:1,hasItems:!0}));case 7:return c=t.sent,l=0===(null==i||null===(o=i.meta)||void 0===o?void 0:o.count),e.setState((function(){return{disableExport:l}})),t.abrupt("return",{results:i.data.map((function(e){var t=c.find((function(t){return t.id===e.inventory_id}));return Te(Te(Te({},t),t?{isDeleted:!1}:{id:e.inventory_id,isDeleted:!0}),e)})),total:i.meta.count,page:r.page,per_page:r.per_page});case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),onLoad:function(t){var n=t.mergeWithEntities,r=t.INVENTORY_ACTION_TYPES,o=t.api;e.setState({getEntities:null==o?void 0:o.getEntities}),(0,I.z2)(Te({},n((0,N.zw)(r,A.XY)))),e.props.setSort(e.state.orderBy,e.state.orderDirection,"CHANGE_SORT")},expandable:"true",filterConfig:{items:[{label:t.label,type:t.type,value:"checkbox-state",filterValues:{items:t.filterValues.items,onChange:function(t,n){return e.updateStateFilter(n)},value:s}},{label:n.label,type:n.type,value:"checkbox-os",filterValues:{items:n.filterValues.items,onChange:function(t,n){return e.updateOSFilter(n)},value:this.state.osFilterValue}}]},activeFiltersConfig:{filters:this.getActiveFilterConfig(),onDelete:this.onDeleteFilters},actionsConfig:{actions:["",{label:"Manage columns",onClick:function(){return e.setColumnModalOpen(!0)}}]},exportConfig:{isDisabled:f,extraItems:[x().createElement("li",{key:"pdf-button-item",role:"menuitem"},x().createElement(R.Button,{key:"pdf-download-button",variant:"none",className:"pf-c-dropdown__menu-item",onClick:function(){return e.setExportSystemsPDF(!0)}},"Export as PDF"))],ouiaId:"export",onSelect:function(t,n){return e.onExportOptionSelect(n)}},onExpandClick:function(t,n,r,o){var i=o.id;return e.props.expandRow(i,r,"EXPAND_ROW")}}),i&&x().createElement(me,{showButton:!1,onSuccess:function(){return e.setExportSystemsPDF(!1)},filters:{stateFilter:s,hostnameOrId:l,osFilter:u},orderBy:p,orderHow:d})))}},{key:"render",value:function(){var e=this;return x().createElement(x().Fragment,null,x().createElement(D.Z,{className:"ros-page-header"},x().createElement(F.Z,{title:"Resource Optimization"}),x().createElement(Re,{isDisabled:this.state.disableExport})),x().createElement(_.Z,null,x().createElement(M.B.Consumer,null,(function(t){return!1===t.permissions.systemsRead?x().createElement(U.Z,{serviceName:"Resource Optimization"}):e.renderConfigStepsOrTable()}))))}}]),f}(x().Component);ze.propTypes={expandRow:k().func,setSort:k().func,isROSConfigured:k().func,showConfigSteps:k().bool,location:k().object,columns:k().array,changeSystemColumns:k().func,addNotification:k().func,clearNotifications:k().func};const Ie=(0,P.withRouter)((0,T.$j)((function(e,t){var n;return Te({showConfigSteps:null===(n=e.isConfiguredReducer)||void 0===n?void 0:n.showConfigSteps,columns:e.systemColumnsReducer.columns},t)}),(function(e){return{expandRow:function(t,n,r){return e({type:r,payload:{id:t,isOpen:n}})},setSort:function(t,n,r){return e({type:r,payload:{key:t,direction:n}})},isROSConfigured:function(){return e((0,B.Pn)())},changeSystemColumns:function(t){return e((0,B.zz)(t))},addNotification:function(t){return e((0,fe.wN)(t))},clearNotifications:function(){return e((0,fe.L1)())}}}))(ze))},30859:(e,t,n)=>{"use strict";n.d(t,{jL:()=>m,S7:()=>h,x2:()=>g,lc:()=>y,tp:()=>v,Q5:()=>w});var r=n(87757),o=n.n(r),i=n(48926),a=n.n(i),s=n(59713),c=n.n(s),l=n(88587),u=n(58061);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e){if(!e.ok)throw Error(e.statusText);return e}var m=function(){var e=new URL(u.RC+u.LO,window.location.origin);return window.insights.chrome.auth.getUser().then((function(){return fetch(e).then(f).then((function(e){return e.json()})).then((function(e){return e}))}))},h=function(e){var t=new URL(u.RC+u.M4+"/".concat(e),window.location.origin);return window.insights.chrome.auth.getUser().then((function(){return fetch(t).then(f).then((function(e){return e.json()})).then((function(e){return e}))}))},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={limit:t.perPage,offset:(t.page-1)*t.perPage};t.description&&t.description.trim()&&(n=d(d({},n),{},{description:t.description}));var r=new URL(u.RC+u.M4+"/".concat(e,"/suggestions"),window.location.origin);r.search=new URLSearchParams(n).toString();var o=window.insights.chrome.auth.getUser().then((function(){return fetch(r).then((function(e){if(!e.ok&&404===e.status)return{hasError:!0};if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){return e}))}));return o},y=function(){var e=a()(o().mark((function e(t){var n,r,i,a,s,c,p,f,m,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return s=(a=t||{}).perPage,c=a.orderBy,p=a.orderHow,f=d(d({order_by:{display_name:"display_name",os:"os","performance_utilization.cpu":"cpu","performance_utilization.memory":"memory","performance_utilization.max_io":"max_io",number_of_suggestions:"number_of_suggestions",state:"state",report_date:"report_date"}[c]||"report_date",order_how:p||l.SortByDirection.desc,limit:s||-1},(null==t?void 0:t.page)&&{offset:(t.page-1)*t.perPage}),(null==t||null===(n=t.filters)||void 0===n?void 0:n.hostnameOrId)&&{display_name:t.filters.hostnameOrId}),m=new URL(u.RC+u.M4,window.location.origin),h=new URLSearchParams(f),null==t||null===(r=t.stateFilter)||void 0===r||r.forEach((function(e){h.append("state",e)})),null==t||null===(i=t.osFilter)||void 0===i||i.forEach((function(e){h.append("os",e)})),m.search=h.toString(),e.abrupt("return",fetch(m).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e,t){var n=new URL("".concat(u.RC).concat(u.M4,"/").concat(e,"/history"),window.location.origin),r=new URLSearchParams({limit:t});return n.search=r.toString(),window.insights.chrome.auth.getUser().then((function(){return fetch(n).then(f).then((function(e){return e.json()})).then((function(e){return e}))}))},w=function(){var e=a()(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.insights.chrome.auth.getUser();case 2:return t=new URL("".concat(u.RC).concat(u.v2),window.location.origin),e.abrupt("return",fetch(t).then((function(e){if(!e.ok)throw Error(e.statusText);return e})).then((function(e){return e.json()})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},94778:(e,t,n)=>{"use strict";n.d(t,{Of:()=>o,t9:()=>i,Pn:()=>a,zz:()=>s});var r=n(30859),o=function(e){return{type:"LOAD_ROS_SYSTEM_INFO",payload:(0,r.S7)(e)}},i=function(e,t){return{type:"FETCH_SYSTEM_RECOMMENDATIONS_LIST",payload:(0,r.x2)(e,t)}},a=function(){return{type:"LOAD_IS_CONFIGURED_INFO",payload:(0,r.jL)()}},s=function(e){return{type:"CHANGE_SYSTEM_COLUMNS",payload:e}}},42480:()=>{},19527:()=>{},69331:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=../sourcemaps/RosPage.8b60e1b312439826c6616b0e801719f0.js.map